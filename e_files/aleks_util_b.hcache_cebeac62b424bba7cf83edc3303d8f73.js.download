/**
 * Copyright © 2024 UC Regents and ALEKS Corporation
 * ALEKS® is a registered trademark of ALEKS Corporation.
**/
if(!global.aleksUtil)var aleksUtil={};var g_lR=aleksUtil;aleksUtil.isArray=function(x){return x.constructor&&x.constructor.toString().match(/^\s*function Array()/)},aleksUtil.isInt=function(x){var y=parseInt(x);return!isNaN(y)&&x==y&&x.toString()==y.toString()},aleksUtil.equalsArray=function(a,b,jokerValue){if(!a||!b||!aleksUtil.isArray(a)||!aleksUtil.isArray(b))return!1;if(a.length!=b.length)return!1;for(var i=0;i<a.length;i++)if(a[i]!=jokerValue&&b[i]!=jokerValue)if(aleksUtil.isArray(a[i])&&aleksUtil.isArray(b[i])){if(aleksUtil.equalsArray(a[i],b[i]))return!1;}else if(a[i]!=b[i])return!1;return!0},aleksUtil.getFrequencies=function(a){for(var freqs={},i=0;i<a.length;i++){if("number"!=typeof a[i]&&"string"!=typeof a[i])return;freqs[a[i]]?freqs[a[i]]++:freqs[a[i]]=1}return freqs},aleksUtil.isDOMElement=function(x){return x.tagName&&x.nodeName&&x.nodeType},aleksUtil.cloneObject=function(x){if(null==x||"function"==typeof x||"object"!=typeof x||x.DONOTCLONE||aleksUtil.isDOMElement(x))return x;if(aleksUtil.isArray(x))return x.slice(0);var clonedObject={};for(var key in x)clonedObject[key]=aleksUtil.cloneObject(x[key]);return clonedObject},aleksUtil.cloneArray=function(array){for(var cloneArray=[],i=0;i<array.length;i++)array[i]&&"object"==typeof array[i]?cloneArray.push(aleksUtil.cloneObject(array[i])):cloneArray.push(array[i]);return cloneArray},function(){var _md5blk=function(s){for(var md5blks=[],i=0;64>i;i+=4)md5blks[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24);return md5blks},_hex_chr="0123456789abcdef".split(""),_rhex=function(n){for(var s="",j=0;4>j;j++)s+=_hex_chr[15&n>>8*j+4]+_hex_chr[15&n>>8*j];return s},_hex=function(x){for(var i=0;i<x.length;i++)x[i]=_rhex(x[i]);return x.join("")},_add32=function(a,b){return 4294967295&a+b},_cmn=function(q,a,b,x,s,t){return a=_add32(_add32(a,q),_add32(x,t)),_add32(a<<s|a>>>32-s,b)},_ff=function(a,b,c,d,x,s,t){return _cmn(b&c|~b&d,a,b,x,s,t)},_gg=function(a,b,c,d,x,s,t){return _cmn(b&d|c&~d,a,b,x,s,t)},_hh=function(a,b,c,d,x,s,t){return _cmn(b^c^d,a,b,x,s,t)},_ii=function(a,b,c,d,x,s,t){return _cmn(c^(b|~d),a,b,x,s,t)},_md5cycle=function(x,k){var a=x[0],b=x[1],c=x[2],d=x[3];a=_ff(a,b,c,d,k[0],7,-680876936),d=_ff(d,a,b,c,k[1],12,-389564586),c=_ff(c,d,a,b,k[2],17,606105819),b=_ff(b,c,d,a,k[3],22,-1044525330),a=_ff(a,b,c,d,k[4],7,-176418897),d=_ff(d,a,b,c,k[5],12,1200080426),c=_ff(c,d,a,b,k[6],17,-1473231341),b=_ff(b,c,d,a,k[7],22,-45705983),a=_ff(a,b,c,d,k[8],7,1770035416),d=_ff(d,a,b,c,k[9],12,-1958414417),c=_ff(c,d,a,b,k[10],17,-42063),b=_ff(b,c,d,a,k[11],22,-1990404162),a=_ff(a,b,c,d,k[12],7,1804603682),d=_ff(d,a,b,c,k[13],12,-40341101),c=_ff(c,d,a,b,k[14],17,-1502002290),b=_ff(b,c,d,a,k[15],22,1236535329),a=_gg(a,b,c,d,k[1],5,-165796510),d=_gg(d,a,b,c,k[6],9,-1069501632),c=_gg(c,d,a,b,k[11],14,643717713),b=_gg(b,c,d,a,k[0],20,-373897302),a=_gg(a,b,c,d,k[5],5,-701558691),d=_gg(d,a,b,c,k[10],9,38016083),c=_gg(c,d,a,b,k[15],14,-660478335),b=_gg(b,c,d,a,k[4],20,-405537848),a=_gg(a,b,c,d,k[9],5,568446438),d=_gg(d,a,b,c,k[14],9,-1019803690),c=_gg(c,d,a,b,k[3],14,-187363961),b=_gg(b,c,d,a,k[8],20,1163531501),a=_gg(a,b,c,d,k[13],5,-1444681467),d=_gg(d,a,b,c,k[2],9,-51403784),c=_gg(c,d,a,b,k[7],14,1735328473),b=_gg(b,c,d,a,k[12],20,-1926607734),a=_hh(a,b,c,d,k[5],4,-378558),d=_hh(d,a,b,c,k[8],11,-2022574463),c=_hh(c,d,a,b,k[11],16,1839030562),b=_hh(b,c,d,a,k[14],23,-35309556),a=_hh(a,b,c,d,k[1],4,-1530992060),d=_hh(d,a,b,c,k[4],11,1272893353),c=_hh(c,d,a,b,k[7],16,-155497632),b=_hh(b,c,d,a,k[10],23,-1094730640),a=_hh(a,b,c,d,k[13],4,681279174),d=_hh(d,a,b,c,k[0],11,-358537222),c=_hh(c,d,a,b,k[3],16,-722521979),b=_hh(b,c,d,a,k[6],23,76029189),a=_hh(a,b,c,d,k[9],4,-640364487),d=_hh(d,a,b,c,k[12],11,-421815835),c=_hh(c,d,a,b,k[15],16,530742520),b=_hh(b,c,d,a,k[2],23,-995338651),a=_ii(a,b,c,d,k[0],6,-198630844),d=_ii(d,a,b,c,k[7],10,1126891415),c=_ii(c,d,a,b,k[14],15,-1416354905),b=_ii(b,c,d,a,k[5],21,-57434055),a=_ii(a,b,c,d,k[12],6,1700485571),d=_ii(d,a,b,c,k[3],10,-1894986606),c=_ii(c,d,a,b,k[10],15,-1051523),b=_ii(b,c,d,a,k[1],21,-2054922799),a=_ii(a,b,c,d,k[8],6,1873313359),d=_ii(d,a,b,c,k[15],10,-30611744),c=_ii(c,d,a,b,k[6],15,-1560198380),b=_ii(b,c,d,a,k[13],21,1309151649),a=_ii(a,b,c,d,k[4],6,-145523070),d=_ii(d,a,b,c,k[11],10,-1120210379),c=_ii(c,d,a,b,k[2],15,718787259),b=_ii(b,c,d,a,k[9],21,-343485551),x[0]=_add32(a,x[0]),x[1]=_add32(b,x[1]),x[2]=_add32(c,x[2]),x[3]=_add32(d,x[3])},_md51=function(s){txt="";for(var i,n=s.length,state=[1732584193,-271733879,-1732584194,271733878],i=64;i<=s.length;i+=64)_md5cycle(state,_md5blk(s.substring(i-64,i)));s=s.substring(i-64);for(var tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<s.length;i++)tail[i>>2]|=s.charCodeAt(i)<<(i%4<<3);if(tail[i>>2]|=128<<(i%4<<3),55<i){_md5cycle(state,tail);for(var i=0;16>i;i++)tail[i]=0}return tail[14]=8*n,_md5cycle(state,tail),state};aleksUtil.md5=function(s){return _hex(_md51(s))}}(),aleksUtil.DOM={},aleksUtil.DOM.disableSelection=function(myDOMElement){myDOMElement.onselectstart=function(e){aleksUtil.event.preventDefault(e)};try{myDOMElement.unselectable="on"}catch(e){}myDOMElement.style&&(myDOMElement.style.MozUserSelect="none",myDOMElement.style.cursor="default")},aleksUtil.DOM.enableSelection=function(myDOMElement){myDOMElement.onselectstart=function(){return!0};try{myDOMElement.unselectable="off"}catch(e){}myDOMElement.style&&(myDOMElement.style.MozUserSelect="text",myDOMElement.style.cursor="text")},aleksUtil.DOM.coverElement=function(parentOftheBlanket,blanketId,blanketOffsetLeft,blanketOffsetTop,blanketWidth,blanketHeight,zIndex,opacity){var div=parentOftheBlanket.ownerDocument.createElement("DIV");div.setAttribute("id",blanketId);var htmlcode="<div style=\"height:"+blanketHeight+"px; width:"+blanketWidth+"px; top:"+blanketOffsetTop+"px; left:"+blanketOffsetLeft+"px; background-color:black;";return htmlcode+="  position:absolute; z-index:"+(zIndex?zIndex:1500)+"; filter:alpha(opacity="+(opacity?100*opacity:0)+");opacity:"+(opacity?opacity:0)+"\"></div>",div.innerHTML=htmlcode,parentOftheBlanket.insertBefore(div,parentOftheBlanket.firstChild),div},aleksUtil.DOM.removeCover=function(parentOftheBlanket,blanketNode){null!=parentOftheBlanket&&null!=blanketNode&&parentOftheBlanket.removeChild(blanketNode)},aleksUtil.DOM.getCSSStyle=function(DOMElement){if("string"==typeof DOMElement&&(DOMElement=di(DOMElement)),!DOMElement)return null;if(window.getComputedStyle)try{return window.getComputedStyle(DOMElement,null)}catch(e){}return DOMElement.currentStyle?DOMElement.currentStyle:void 0},aleksUtil.DOM.setCSSStyle=function(DOMElement,styleString){return"string"==typeof DOMElement&&(DOMElement=di(DOMElement)),DOMElement?void(void 0===DOMElement.style.cssText?DOMElement.setAttribute("style",styleString):DOMElement.style.cssText=styleString):null},aleksUtil.DOM.setCSSPos=function(DOMElement,DOMElementLeft,DOMElementTop){return"string"==typeof DOMElement&&(DOMElement=di(DOMElement)),DOMElement?void(DOMElement.style.left=DOMElementLeft+"px",DOMElement.style.top=DOMElementTop+"px"):null},aleksUtil.DOM.setCSSFixed=function(DOMElement,HAlign,HPos,VAlign,VPos){if("string"==typeof DOMElement&&(DOMElement=di(DOMElement)),!DOMElement)return null;if(!HAlign)var HAlign="left";if(!HPos)var HPos=0;if(!VAlign)var VAlign="top";if(!VPos)var VPos=0;DOMElement.style.position="fixed",DOMElement.style["left"===HAlign?"right":"left"]="auto",DOMElement.style["top"===VAlign?"bottom":"top"]="auto",DOMElement.style[HAlign]=HPos+"px",DOMElement.style[VAlign]=VPos+"px"},aleksUtil.DOM.createCSS=function(CSSString){var headers=document.getElementsByTagName("head");if(!headers||!headers.length)var target=document.body;else var target=headers[0];var styleEl=document.createElement("style");return styleEl.type="text/css",styleEl.media="screen",styleEl.styleSheet?styleEl.styleSheet.cssText=CSSString:styleEl.appendChild(document.createTextNode(CSSString)),target.appendChild(styleEl),styleEl},aleksUtil.DOM.hideElement=function(myDOMElement){myDOMElement.style.display="none"},aleksUtil.DOM.showElement=function(myDOMElement){myDOMElement.style.display="block"},aleksUtil.DOM.contains=function(a,b){return!(a!=b)||(a.contains?a!=b&&a.contains(b):!!(16&a.compareDocumentPosition(b)))},aleksUtil.DOM.spinnerCover=function(){},aleksUtil.DOM.spinnerCover.prototype.createHtml=function(DOMParent,w,h){this.spinnerContainer=document.createElement("div"),!w&&(w=DOMParent.clientWidth),!h&&(h=DOMParent.clientHeight),aleksUtil.DOM.setCSSStyle(this.spinnerContainer,"width:"+w+"px;height:"+h+"px;z-index:10;background-color:#FFFFFF;position:absolute;top:0px;left:0px;border:1px solid black;overflow:hidden;"),this.spinnerContainer.innerHTML="<table style='width:100%;height:100%;'><tr align='center'><td valign='center'><img src='/aleks/gif/icon_wait.gif'></img></td></tr></table>",DOMParent.appendChild(this.spinnerContainer)},aleksUtil.DOM.spinnerCover.prototype.show=function(DOMParent,w,h){!this.spinnerContainer&&this.createHtml(DOMParent,w,h),this.spinnerContainer.style.display="block"},aleksUtil.DOM.spinnerCover.prototype.hide=function(){this.spinnerContainer.style.display="none"},aleksUtil.htmlDOM=aleksUtil.DOM,aleksUtil.event={},aleksUtil.event.preventDefault=function(e){if(!e)var e=window.event;!e||(e.preventDefault&&e.preventDefault(),e.returnValue=!1)},aleksUtil.event.cancelBubbling=function(e){if(!e)var e=window.event;!e||(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())},aleksUtil.event.getEventTarget=function(e){var targ;if(!e)var e=window.event;return e?(e.target?targ=e.target:e.srcElement&&(targ=e.srcElement),3==targ.nodeType&&(targ=targ.parentNode),targ):void 0},aleksUtil.event.getCharFromEvent=function(e){if(!e)var e=window.event;if(e){var keynum;return window.event?keynum=e.keyCode:e.which&&(keynum=e.which),String.fromCharCode(keynum)}},aleksUtil.event.isRightClick=function(e){var rightclick;if(!e)var e=window.event;return e?(e.which?rightclick=3==e.which:e.button&&(rightclick=2==e.button),rightclick):void 0},aleksUtil.math={},aleksUtil.math.setLimitValues=function(val){aleksUtil.math.useLimitValues=val},aleksUtil.math.getLimitValues=function(){return aleksUtil.math.useLimitValues},aleksUtil.math.plus=function(a,b){if(!a.type&&!b.type){if((Math.floor(a)!=a||Math.floor(b)!=b)&&1e10>Math.abs(a)&&1e-10<Math.abs(a)&&1e10>Math.abs(b)&&1e-10<Math.abs(b)){if(Math.floor(a)==a)var amult=1;else var amult=Math.abs(a).toString().match(/.\d+/)[0].length-1;if(Math.floor(b)==b)var bmult=1;else var bmult=Math.abs(b).toString().match(/.\d+/)[0].length-1;var maxmult=Math.pow(10,Math.max(amult,bmult));return(a*maxmult+b*maxmult)/maxmult}return a+b}if("complex"==a.type||"complex"==b.type){"complex"!=a.type&&(a=aleksUtil.math.getComplex(a)),"complex"!=b.type&&(b=aleksUtil.math.getComplex(b));var r=aleksUtil.math.getComplex(a.r+b.r,a.i+b.i);return r.i?r:r.r}if("list"==a.type&&!b.type){for(var i=0;i<a.array.length;i++)a.array[i]=aleksUtil.math.plus(a.array[i],b);return a}if("list"==b.type&&!a.type){for(var i=0;i<b.array.length;i++)b.array[i]=aleksUtil.math.plus(b.array[i],a);return b}if("matrix"==a.type||"matrix"==b.type){var resultMatrix=[];if(!a||!b||a.rows!=b.rows||a.cols!=b.cols)return Number.NaN;for(var resultRow,i=0;i<a.rows;i++){resultRow=[];for(var j=0;j<a.cols;j++)resultRow[j]=a.mat[i][j]+b.mat[i][j];resultMatrix.push(resultRow)}return aleksUtil.math.getMatrix(resultMatrix)}return Number.NaN},aleksUtil.math.minus=function(a,b){if(!a.type&&!b.type){if((Math.floor(a)!=a||Math.floor(b)!=b)&&1e10>Math.abs(a)&&1e-10<Math.abs(a)&&1e10>Math.abs(b)&&1e-10<Math.abs(b)){if(Math.floor(a)==a)var amult=1;else var amult=Math.abs(a).toString().match(/.\d+/)[0].length-1;if(Math.floor(b)==b)var bmult=1;else var bmult=Math.abs(b).toString().match(/.\d+/)[0].length-1;var maxmult=Math.pow(10,Math.max(amult,bmult));return(a*maxmult-b*maxmult)/maxmult}return a-b}if("complex"==a.type||"complex"==b.type){"complex"!=a.type&&(a=aleksUtil.math.getComplex(a)),"complex"!=b.type&&(b=aleksUtil.math.getComplex(b));var r=aleksUtil.math.getComplex(a.r-b.r,a.i-b.i);return r.i?r:r.r}if("list"==a.type&&!b.type){for(var i=0;i<a.array.length;i++)a.array[i]=aleksUtil.math.minus(a.array[i],b);return a}if("list"==b.type&&!a.type){for(var i=0;i<b.array.length;i++)b.array[i]=aleksUtil.math.minus(a,b.array[i]);return b}if("matrix"==a.type||"matrix"==b.type){var resultMatrix=[];if(!a||!b||a.rows!=b.rows||a.cols!=b.cols)return Number.NaN;for(var resultRow,i=0;i<a.rows;i++){resultRow=[];for(var j=0;j<a.cols;j++)resultRow[j]=a.mat[i][j]-b.mat[i][j];resultMatrix.push(resultRow)}return aleksUtil.math.getMatrix(resultMatrix)}return Number.NaN},aleksUtil.math.plusminus=function(a,b){return a.type||b.type?Number.NaN:aleksUtil.math.getList(a-b,a+b)},aleksUtil.math.times=function(a,b){if(!a.type&&!b.type)return a*b;if("complex"==a.type||"complex"==b.type){"complex"!=a.type&&(a=aleksUtil.math.getComplex(a)),"complex"!=b.type&&(b=aleksUtil.math.getComplex(b));var r=aleksUtil.math.getComplex(a.r*b.r-a.i*b.i,a.r*b.i+a.i*b.r);return r.i?r:r.r}if("list"==a.type&&!b.type){for(var i=0;i<a.array.length;i++)a.array[i]=aleksUtil.math.times(a.array[i],b);return a}if("list"==b.type&&!a.type){for(var i=0;i<b.array.length;i++)b.array[i]=aleksUtil.math.times(b.array[i],a);return b}if("matrix"==a.type||"matrix"==b.type){if(!isNaN(a)||!isNaN(b)){for(var resultRow,number=isNaN(a)?b:a,matrix=isNaN(a)?a:b,resultMatrix=[],i=0;i<matrix.rows;i++){resultRow=[];for(var j=0;j<matrix.cols;j++)resultRow[j]=number*matrix.mat[i][j];resultMatrix.push(resultRow)}return aleksUtil.math.getMatrix(resultMatrix)}if(a.cols==b.rows){for(var resultRow,resultMatrix=[],i=0;i<a.rows;i++){resultRow=[];for(var resultNumber,j=0;j<b.cols;j++){resultNumber=0;for(var k=0;k<a.cols;k++)resultNumber+=a.mat[i][k]*b.mat[k][j];resultRow.push(resultNumber)}resultMatrix.push(resultRow)}return aleksUtil.math.getMatrix(resultMatrix)}}return Number.NaN},aleksUtil.math.div=function(a,b){if(!a.type&&!b.type)return 0==b?Number.NaN:a/b;if("complex"==a.type||"complex"==b.type){"complex"!=a.type&&(a=aleksUtil.math.getComplex(a)),"complex"!=b.type&&(b=aleksUtil.math.getComplex(b));var denom=aleksUtil.math.pow(b.r,2)+aleksUtil.math.pow(b.i,2);if(0==denom)return Number.NaN;var r=aleksUtil.math.getComplex((a.r*b.r+a.i*b.i)/denom,(a.i*b.r-a.r*b.i)/denom);return r.i?r:r.r}if("list"==a.type&&!b.type){for(var i=0;i<a.array.length;i++)a.array[i]=aleksUtil.math.div(a.array[i],b);return a}return"matrix"!=a.type||isNaN(b)?Number.NaN:aleksUtil.math.times(a,1/b)},aleksUtil.math.sqrt=function(a){if(!a.type&&0<=a)return Math.sqrt(a);return"complex"==a.type||0>a?aleksUtil.math.pow(a,aleksUtil.math.getComplex(1/2)):Number.NaN},aleksUtil.math.pow=function(a,b){if(!a.type&&!b.type&&(0<=a||0==b%2)){if((!isFinite(a)||0===a)&&0===b)return Number.NaN;return 0===a&&0>=b?Number.NaN:Math.pow(a,b)}if("complex"==a.type&&0==a.r&&1==Math.abs(a.i)&&aleksUtil.math.isInt(b))switch(Math.abs(b)%4){case 0:return 1;case 1:return aleksUtil.math.getComplex(0,a.i*aleksUtil.math.sign(b));case 2:return-1;case 3:return aleksUtil.math.getComplex(0,-1*a.i*aleksUtil.math.sign(b))}else{if("complex"==a.type||"complex"==b.type||0>a){if("complex"!=a.type&&(a=aleksUtil.math.getComplex(a)),"complex"!=b.type&&(b=aleksUtil.math.getComplex(b)),a.isNaN()||b.isNaN())return Number.NaN;if(0<=a.r&&!a.i&&!b.i)return aleksUtil.math.pow(a.r,b.r);if(0<=a.r&&!a.i){var newModulus=aleksUtil.math.pow(a.r,b.r)*aleksUtil.math.pow(Math.E,-a.a*b.i),realPart=newModulus*aleksUtil.math.cos(b.i*aleksUtil.math.ln(a.m)),imgPart=newModulus*aleksUtil.math.sin(b.i*aleksUtil.math.ln(a.m));return imgPart?aleksUtil.math.getComplex(realPart,imgPart):realPart}var powModulus=aleksUtil.math.pow(aleksUtil.math.pow(a.m,2),aleksUtil.math.div(b,2)),rightArg=aleksUtil.math.times(aleksUtil.math.times(aleksUtil.math.getComplex(0,1),b),a.a);return aleksUtil.math.times(powModulus,aleksUtil.math.pow(Math.E,rightArg))}if("matrix"==a.type&&aleksUtil.math.isInt(b)){if(-1>b||a.cols!=a.rows)return Number.NaN;if(-1==b){var det=aleksUtil.math.determinant(a.mat);if(!det)return Number.NaN;for(var resultArray,resultMatrix=[],i=0;i<a.rows;i++){resultArray=[];for(var j=0;j<a.cols;j++)resultArray.push(aleksUtil.math.matrixCofactor(a,j,i)/det);resultMatrix.push(resultArray)}return aleksUtil.math.getMatrix(resultMatrix)}if(1==b)return a;if(0==b){for(var x,resultMatrix=[],i=0;i<a.rows;i++){x=[];for(var j=0;j<a.cols;j++)x[j]=0;x[i]=1,resultMatrix.push(x)}return aleksUtil.math.getMatrix(resultMatrix)}if(100>b){for(var mat=a,i=1;i<b;i++)mat=aleksUtil.math.times(mat,a);return mat}}}return Number.NaN},aleksUtil.math.exp=function(a){return aleksUtil.math.pow(Math.E,a)},aleksUtil.math.ln=function(a){if(!a.type)return 0!=a||aleksUtil.math.useLimitValues?Math.log(a):Number.NaN;return"complex"==a.type?aleksUtil.math.getComplex(Math.ln(a.m),a.a):Number.NaN},aleksUtil.math.log=function(a){return aleksUtil.math.ln(a)/aleksUtil.math.ln(10)},aleksUtil.math.isInt=function(n){return"complex"==n.type&&0==n.i&&(n=n.r),!isNaN(n)&&isFinite(n)&&Math.ceil(n)==Math.floor(n)},aleksUtil.math.isNaN=function(a){return a!=a},aleksUtil.math.factorial=function(n){if(isNaN(n)||!isFinite(n)||0>n||Math.floor(n)!=n)return Number.NaN;if(180<n)return Number.POSITIVE_INFINITY;for(var res=1,i=1;i<=n;i++)res*=i;return res},aleksUtil.math.combination=function(n,k){var n=aleksUtil.math.toStdPrecision(n),k=aleksUtil.math.toStdPrecision(k);return aleksUtil.math.isInt(n)&&aleksUtil.math.isInt(k)?k>n?0:aleksUtil.math.permutation(n,k)/aleksUtil.math.factorial(k):Number.NaN},aleksUtil.math.permutation=function(n,k){var n=aleksUtil.math.toStdPrecision(n),k=aleksUtil.math.toStdPrecision(k);return aleksUtil.math.isInt(n)&&aleksUtil.math.isInt(k)?k>n?0:aleksUtil.math.factorial(n)/aleksUtil.math.factorial(n-k):Number.NaN},aleksUtil.math.nroot=function(x,n){if(0==n&&1<Math.abs(x)||0==n&&0>x)return Number.NaN;if(0==n&&1>x)return 0;if(0==n&&1==x)return 1;if(1==n%2&&0>x)var res=-aleksUtil.math.pow(Math.abs(x),1/Math.abs(n));else var res=aleksUtil.math.pow(x,1/Math.abs(n));if(0>n){if(0==res)return Number.NaN;var res=aleksUtil.math.div(1,res)}return res},aleksUtil.math.sign=function(x,nonStrict){return nonStrict?0<=x?1:-1:0==x?0:0<x?1:-1},aleksUtil.math.gcd=function(a,b){if(!aleksUtil.math.isInt(a)||!aleksUtil.math.isInt(b))return Number.NaN;for(var c;0<b;)c=b,b=a%b,a=c;return a},aleksUtil.math.factorize=function(x,stacks){var x=+x;if(!(isNaN(x)||1e10<Math.abs(x))){for(var pFactors=[],target=x,max=Math.sqrt(x),div=2;div<=max;)Math.floor(target/div)==target/div&&(pFactors.push(div),target/=div,max=Math.sqrt(target),div=1),div++;if(pFactors.push(target),stacks){for(var pObject={},i=0;i<pFactors.length;i++)pObject[pFactors[i]]?pObject[pFactors[i]]++:pObject[pFactors[i]]=1;return pObject}return pFactors}},aleksUtil.math.cos=function(x){var quot=(x-Math.PI/2)/Math.PI;return Math.floor(quot)==quot?0:Math.cos(x)},aleksUtil.math.sin=function(x){var quot=x/Math.PI;return Math.floor(quot)==quot?0:Math.sin(x)},aleksUtil.math.tan=function(x){var sx=x;0>sx&&(sx+=Math.PI*(Math.floor(Math.abs(sx)/Math.PI)+1));var trigVal=aleksUtil.math.moduloTrig(sx,Math.PI);return trigVal===Math.PI/4?1:trigVal===Math.PI/2?Number.NaN:trigVal===3*Math.PI/4?-1:aleksUtil.math.sin(x)/aleksUtil.math.cos(x)},aleksUtil.math.csc=function(x){return 0==aleksUtil.math.moduloTrig(x,Math.PI)?Number.NaN:1/aleksUtil.math.sin(x)},aleksUtil.math.sec=function(x){return 0==aleksUtil.math.moduloTrig(x,Math.PI/2)&&0!=aleksUtil.math.moduloTrig(x,Math.PI)?Number.NaN:1/aleksUtil.math.cos(x)},aleksUtil.math.cot=function(x){if(0==aleksUtil.math.moduloTrig(x,Math.PI))return Number.NaN;return 0==aleksUtil.math.moduloTrig(x,Math.PI/2)?0:1/aleksUtil.math.tan(x)},aleksUtil.math.moduloTrig=function(x,y){return 1e-200>Math.abs(x%y)?0:x%y},aleksUtil.math.roundNumber=function(n){var n=+n;if(!isNaN(n)){var sgn=aleksUtil.math.sign(n),n=Math.abs(n),floorPart=Math.floor(+n.toExponential(10));if(0==n);else if(1e-10>n||1e11<n){n=n.toExponential();var exponent=(n+"").match(/e(\+|-)\d+/g)[0].replace(/e\+?/,"E"),mantissa=(n+"").match(/^[0-9.]+/)[0];mantissa=+(+mantissa).toFixed(10),n=mantissa+exponent}else if(0!=floorPart)n=+n.toFixed(Math.max(0,11-(floorPart+"").length));else{var expForm=n.toExponential(10),expValue=+(expForm+"").match(/(\+|-)\d+/g)[0],digits=(+(n*aleksUtil.math.pow(10,-expValue)).toFixed(10)+"").replace(/\./,""),n="0."+Array(Math.abs(expValue)).join("0")+digits;n=n.replace(/(\d)0+$/g,"$1")}return(0>sgn?"-":"")+(n+"")}},aleksUtil.math.toStdPrecision=function(n){var n=+n;return isNaN(n)?void 0:+n.toExponential(10)},aleksUtil.math.toFraction=function(n){if(!isNaN(n)){var sign=n/Math.abs(n),n=Math.abs(n),expForm=(+Math.abs(n).toExponential(14)).toExponential(),mantissa=expForm.replace(/e(\+|-)\d+/g,""),exp=expForm.match(/e(\+|-)\d+/g,"")[0].replace(/e/,""),digits=mantissa.replace(/(^\d)?\./g,""),matchRepeat1=digits.match(/(\d)\1{5}\d?$/),matchRepeat2=digits.match(/(\d{2})\1{2}\d?$/),matchRepeat3=digits.match(/(\d{3})\1{2}\d?$/);if(matchRepeat1){for(var repeatedDecimal=matchRepeat1[1],commaShift=digits.length-6,numerator=Math.floor(mantissa*aleksUtil.math.pow(10,commaShift+1))-Math.floor(mantissa*aleksUtil.math.pow(10,commaShift)),denominator=9*aleksUtil.math.pow(10,commaShift-+exp),gcd=aleksUtil.math.gcd(numerator,denominator);1<gcd;){numerator/=gcd,denominator/=gcd;var gcd=aleksUtil.math.gcd(numerator,denominator)}return[sign*numerator,denominator]}if(matchRepeat2){for(var repeatedDecimal=matchRepeat2[1],commaShift=digits.length-6,numerator=Math.floor(mantissa*aleksUtil.math.pow(10,commaShift+2))-Math.floor(mantissa*aleksUtil.math.pow(10,commaShift)),denominator=99*aleksUtil.math.pow(10,commaShift-+exp),gcd=aleksUtil.math.gcd(numerator,denominator);1<gcd;){numerator/=gcd,denominator/=gcd;var gcd=aleksUtil.math.gcd(numerator,denominator)}return[sign*numerator,denominator]}if(matchRepeat3){for(var repeatedDecimal=matchRepeat3[1],commaShift=digits.length-6,numerator=Math.floor(mantissa*aleksUtil.math.pow(10,commaShift+3))-Math.floor(mantissa*aleksUtil.math.pow(10,commaShift)),denominator=999*aleksUtil.math.pow(10,commaShift-+exp),gcd=aleksUtil.math.gcd(numerator,denominator);1<gcd;){numerator/=gcd,denominator/=gcd;var gcd=aleksUtil.math.gcd(numerator,denominator)}return[sign*numerator,denominator]}if("1"==mantissa)return 1<=1/n&&1e4>1/n?["1",1/n]:[sign,"10^["+ +-+exp+"]"];if(6>digits.length&&1e4>Math.abs(n)&&1e-4<Math.abs(n)){for(var numerator=1e4*n,denominator=1e4,gcd=aleksUtil.math.gcd(numerator,denominator);1<gcd;){numerator/=gcd,denominator/=gcd;var gcd=aleksUtil.math.gcd(numerator,denominator)}return[sign*numerator,denominator]}}},aleksUtil.math.toDegrees=function(angle){return 180*angle/Math.PI},aleksUtil.math.toRadians=function(angle){return angle*Math.PI/180},aleksUtil.math.calculateCircleAngle=function(x,y){var angle=Math.atan(Math.abs(y)/Math.abs(x));if(0==x){if(0<y)return Math.PI/2;if(0>y)return 3/2*Math.PI}else{if(0<x&&0<=y)return angle;if(0>x&&0<y)return Math.PI-angle;if(0>x&&0>=y)return Math.PI+angle;if(0<x&&0>y)return 2*Math.PI-angle}},aleksUtil.math.toPolarCoordinates=function(x,y){var r=Math.sqrt(Math.pow(x,2)+Math.pow(y,2)),theta=aleksUtil.math.calculateCircleAngle(x,y);return[r,theta]},aleksUtil.math.toCartesianCoordinates=function(r,theta){return[r*aleksUtil.math.cos(theta),r*aleksUtil.math.sin(theta)]},aleksUtil.math.getComplex=function(r,i){void 0===r&&(r=0),void 0===i&&(i=0);var c={type:"complex",r:r,i:i};return c.m=aleksUtil.math.sqrt(aleksUtil.math.pow(r,2)+aleksUtil.math.pow(i,2)),c.a=0==r?0>i?-Math.PI/2:0<i?Math.PI/2:0:Math.atan(i/r),0>r&&(c.a+=Math.PI),0==r&&0==i&&(c.a=0),(isNaN(c.r)||isNaN(c.i)||isNaN(c.m)||isNaN(c.a))&&(c.r=Number.NaN,c.i=Number.NaN,c.m=Number.NaN,c.a=Number.NaN),c.toString=function(){return this.r+"+"+this.i+"i"},c.isNaN=function(){return isNaN(this.r)||isNaN(this.i)||isNaN(this.m)||isNaN(this.a)},c},aleksUtil.math.getEuclideanNorm=function(x){var norm=Number.NaN;if(!x.type)norm=aleksUtil.math.sqrt(aleksUtil.math.times(x,x));else if("complex"==x.type){var conjugateX=aleksUtil.math.getComplex(x.r,aleksUtil.math.times(-1,x.i)),calculatedNorm=aleksUtil.math.sqrt(aleksUtil.math.times(x,conjugateX));calculatedNorm.type?"complex"==calculatedNorm.type&&(norm=calculatedNorm.r):norm=calculatedNorm}return norm},aleksUtil.math.approximatelyEqual=function(x,y,tolerance){var isApproximatelyEqual=!1;return aleksUtil.math.getEuclideanNorm(aleksUtil.math.minus(y,x))<tolerance&&(isApproximatelyEqual=!0),isApproximatelyEqual},aleksUtil.math.getMatrix=function(m){if(!m.length||!m[0].length)return Number.NaN;for(var mo={rows:m.length,cols:m[0].length},duplicateMatrix=[],i=0;i<m.length;i++)duplicateMatrix.push(m[i].slice(0));return mo.mat=duplicateMatrix,mo.type="matrix",mo},aleksUtil.math.matrixCofactor=function(a,i,j){if("matrix"==a.type){for(var cofactorMatrix=[],k=0;k<a.rows;k++)k!=i&&cofactorMatrix.push(a.mat[k].slice(0,j).concat(a.mat[k].slice(j+1)));return aleksUtil.math.pow(-1,i+j)*aleksUtil.math.determinant(cofactorMatrix)}},aleksUtil.math.determinant=function(m){for(var n=m.length,originalArray=[],i=0;i<n;i++)if(originalArray[i]=i,m[i].length!=n)return Number.NaN;for(var permutations=aleksUtil.math.permute(originalArray),det=0,i=0;i<permutations.length;i++){for(var perm=permutations[i],permSig=aleksUtil.math.signature(originalArray,perm),p=permSig,j=0;j<perm.length;j++)p*=m[j][perm[j]];det+=p}return det},aleksUtil.math.getList=function(n){for(var result={type:"list",array:[n]},i=1;i<arguments.length;i++)result.array.push(arguments[i]);return result},aleksUtil.math.sum=function(valueArray){for(var result=0,i=0;i<valueArray.length;i++)result+=valueArray[i];return result},aleksUtil.math.mean=function(valueArray){return aleksUtil.math.sum(valueArray)/valueArray.length},aleksUtil.math.max=function(valueArray){if(!valueArray||!valueArray.length)return null;for(var result=valueArray[0],i=0;i<valueArray.length;i++)result<valueArray[i]&&(result=valueArray[i]);return result},aleksUtil.math.min=function(valueArray){if(!valueArray||!valueArray.length)return null;for(var result=valueArray[0],i=0;i<valueArray.length;i++)result>valueArray[i]&&(result=valueArray[i]);return result},aleksUtil.math.permute=function(x){if(!x.length)return[[]];if(1==x.length)return[x];for(var resultArrays=[],i=0;i<x.length;i++){var targetElement=x[i],slicedArray=x.slice(0);slicedArray.splice(i,1);for(var permutedArrays=aleksUtil.math.permute(slicedArray),j=0;j<permutedArrays.length;j++)permutedArrays[j].unshift(targetElement);resultArrays=resultArrays.concat(permutedArrays)}return resultArrays},aleksUtil.math.signature=function(o,p){for(var pc=p.slice(0),permutations=0,i=0;i<o.length;i++)pc.indexOf(o[i])!=i&&(pc[pc.indexOf(o[i])]=pc[i],pc[i]=o[i],permutations++);return 0==permutations%2?1:-1},aleksUtil.math.getLineEquation=function(p1,p2){var x1=p1[0],x2=p2[0],y1=p1[1],y2=p2[1];if(x1!=x2||y1!=y2){if(x1==x2)return[1,0,-x1];if(y1==y2)return[0,1,-y1];var a=(y1-y2)/(x2-x1),c=-a*x1-y1;return[a,1,c]}},aleksUtil.math.getDistanceToPoint=function(p1,p2){return Math.sqrt(Math.pow(p2[0]-p1[0],2)+Math.pow(p2[1]-p1[1],2))},aleksUtil.math.getDistanceToLine=function(p,l){return Math.abs(l[0]*p[0]+l[1]*p[1]+l[2])/Math.sqrt(Math.pow(l[0],2)+Math.pow(l[1],2))},aleksUtil.math.getDistanceToSegment=function(p,s){if(Math.min(s[0][0],s[1][0])<p[0]&&p[0]<Math.max(s[0][0],s[1][0])||Math.min(s[0][1],s[1][1])<p[1]&&p[1]<Math.max(s[0][1],s[1][1])){var l=aleksUtil.math.getLineEquation(s[0],s[1]),d3=aleksUtil.math.getDistanceToLine(p,l);return d3}var d1=aleksUtil.math.getDistanceToPoint(p,s[0]),d2=aleksUtil.math.getDistanceToPoint(p,s[1]);return Math.min(d1,d2)},aleksUtil.math.getDistanceToSquare=function(p,s){for(var x=s[0],y=s[1],w=s[2],h=s[3],segs=[[[x,y],[x+w,y]],[[x+w,y],[x+w,y+h]],[[x+w,y+h],[x,y+h]],[[x,y+h],[x,y]]],dists=[],i=0;i<segs.length;i++)dists.push(aleksUtil.math.getDistanceToSegment(p,segs[i]));return dists.sort(function(a,b){return a-b}),dists[0]},aleksUtil.math.gamma=function(n){if(n.type||0>n)return Number.NaN;var g=7,p=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];if(.5>n)return Math.PI/(aleksUtil.math.sin(Math.PI*n)*aleksUtil.math.gamma(1-n));n-=1;for(var x=p[0],i=1;i<g+2;i++)x+=p[i]/(n+i);var t=n+g+.5,result=Math.sqrt(2*Math.PI)*Math.pow(t,n+.5)*Math.exp(-t)*x;return+result.toExponential(10)},aleksUtil.math.beta=function(x,y){return 0>=x&&0>=y?Number.NaN:aleksUtil.math.div(aleksUtil.math.times(aleksUtil.math.gamma(x),aleksUtil.math.gamma(y)),aleksUtil.math.gamma(aleksUtil.math.plus(x,y)))},aleksUtil.math.toExponential=function(n,d){var diff=+(n-+n.toExponential(d)).toExponential(10);return 5==diff*Math.pow(10,-1*Math.floor(aleksUtil.math.log(diff)))?(+(n+diff).toExponential(12)).toExponential(d):n.toExponential(d)},aleksUtil.math.PV=function(C,i,n){return 0>C||0>i||0>n?Number.NaN:aleksUtil.math.times(C,aleksUtil.math.div(C,aleksUtil.math.pow(aleksUtil.math.plus(1,i),n)))},aleksUtil.math.PVoA=function(C,i,n){return 0>C||0>=i||0>n?Number.NaN:aleksUtil.math.times(C,aleksUtil.math.div(aleksUtil.math.minus(1,aleksUtil.math.pow(aleksUtil.math.plus(1,i),-n)),i))},aleksUtil.math.normalCDF=function(y){var f,h,j,dcphi,x,z,f1,f2,f3,f4,f5,r=[1.2533141373155003,1.1931829647319152,1.1374909212036046,1.0858270274680037,1.0378245758537268,.9931557904881572,.9515271920712067,.9126755670832122,.8763644564536923,.84238109145213,.8105337152790304,.7806492378708634,.7525711790634081,.7261578617139919,.7012808218544301,.6778234075911775,.6556795424187984,.6347526319769262,.6149545961509297,.5962050108690213,.5784303460476311,.5615632879362914,.545542135658217,.5303102630712526,.5158156382179634,.502010393620417,.48885044152757373,.47629512896051,.4643069280394422,.4528511576306266,.44189573283260003,.43141093924000323,.4213692292880545,.4117450382989767,.4025146181296717,.3936558865630571,.38514829079843427,.3769726835829618,.3691112106902638,.36154720859634004,.3542651113297933,.34725036558519684,.340489353287085,.33396932087918235,.32767831469055236,.3216051217986084,.31573921586941034,.3100707075093598,.304590298710103,.29928924101087695,.2941592970402896,.28919270513321227,.2843821467484926,.27972071644000907,.27520189415760615,.270819519675909,.2665677689682235,.26244113236003597,.25843439431203824,.2545426146965893,.25076111144396523,.24708544444608058,.24351140061545623,.24003498000639087,.23665238291356047,.2333599978706986,.23015439047880062,.2270322929993801,.2239905946538291,.22102633257497697,.21813668336147102,.21531895518973632,.21257058044203206,.2098891088125368,.20727220085650075,.20471762195033022,.20222323663305453,.19978700330198626,.19740696923751944,.1950812659339918,.19280810471531556,.19058577261574028,.18841262850760018,.18628709945929098,.18420767730797033,.1821729154326492,.18018142571439155,.17823187567133156,.1763229857571026,.17445352681211268,.17262231765785077,.17082822282511367,.1690701504076942,.16734705003365535,.1656579109468774,.16400176019206403,.16237766089686734,.16078471064521938,.15922203993636733,.15768881072447175,.1561842150339761,.15470747364627135,.15325783485347902,.15183457327544114,.15043698873626915,.149064405197033,.14771616974139326,.14639165161118275,.14509024128913084,.14381134962610503,.14255440701040226,.14131886257677895,.1401041834530502,.13890985404222025,.13773537533823035,.13658026427352798,.13544405309676352,.1343262887790272,.13322653244712926,.1321443588425154,.1310793558044918,.13003112377651022,.12899927533433747,.12798343473499657,.12698323748543688,.1259983299299428,.12502836885535032,.1240730211131909,.12313196325793226,.12220488120052962,.12129146987654613,.12039143292813971,.11950448239925308,.1186303384433775,.11776872904329794,.11691938974225351,.11608206338598234,.11525649987514432,.11444245592764314,.11363969485039356,.11284798632010304,.11206710617265928,.11129683620073585,.11053696395924793,.1097872825783083,.1090475905833519,.10831769172211304,.10759739479815637,.10688651351067442,.10618486630028322,.1054922762005561,.10480857069505113,.10413358157959822,.10346714482962362,.10280910047230002,.10215929246332031,.10151756856810279,.10088378024724459,.10025778254604852,.09963943398795666,.09902859647173191,.09842513517223564,.09782891844465687,.09723981773205465,.09665770747608199,.09608246503076462,.09551397057921561,.09495210705316912,.09439676005522443,.093847817783695,.0933051709599617,.09276871275823452,.09223833873763036,.09171394677647927,.09119543700877474,.09068271176268733,.0901756755010647,.08967423476384374,.08917829811230432,.08868777607509647,.08820258109597616,.08772262748318727,.08724783136042985,.08677811061935764,.08631338487354936,.08585357541390161,.08539860516539226,.08494839864516607,.0845028819218957,.08406198257637364,.0836256296632913,.08319375367416516,.08276628650136914,.08234316140323582,.08192431297018951,.08150967709187601,.08109919092525535,.08069279286362471,.08029042250654046,.07989202063060893,.0794975291611172,.07910689114447579,.07872005072144661,.07833695310113016,.07795754453568719,.07758177229577093,.07720958464664666,.0768409308249766,.07647576101624849,.07611402633282746,.07575567879261111,.0754006712982688,.07504895761704657,.0747004923611199,.07435523096847724,.07401312968431743,.07367414554294563,.0733382363501515,.07300536066605565,.07267547778840923,.07234854773633337,.0720245312344847,.07170338969763432,.07138508521564745,.07106958053885215,.07075683906378473,.0704468248193017,.07013950245304623,.06983483721825944,.069532794960926,.06923334210724438,.06893644565141219,.06864207314371744,.06835019267892699,.06806077288496333,.06777378291186177,.0674891924209997,.06720697157459027,.06692709102543308,.06664952190691442,.06637423582325018];return x=y,15<Math.abs(x)?dcphi=0:(j=Math.floor(16*Math.abs(x)+.5),z=.0625*j,h=Math.abs(x)-z,f=r[j],f1=f*z-1,f2=f+z*f1,f3=2*f1+z*f2,f4=3*f2+z*f3,f5=4*f3+z*f4,dcphi=f+h*(120*f1+h*(60*f2+h*(20*f3+h*(5*f4+h*f5))))/120,dcphi=.3989422804014327*dcphi*Math.exp(-.5*x*x)),0>x?dcphi:1-dcphi},aleksUtil.math.chisqCDF=function(x,df){return!aleksUtil.isInt(df)||0>=df?Number.NaN:aleksUtil.math.gammaCDF(.5*df,.5*x)},aleksUtil.math.gammaCDF=function(a,x){var gln,p;return 0>=x||0>=a?0:1e4<a?aleksUtil.math.gammaNormalApproximation(a,x):(gln=aleksUtil.math.lngamma(a),x<a+1?aleksUtil.math.gammaSeriesApproximation(a,x,gln):1-aleksUtil.math.gammaFractionApproximation(a,x,gln))},aleksUtil.math.lngamma=function(xx){var x,tmp,ser,COF1=76.18009173,COF2=-86.50532033,COF3=24.01409822,COF4=-1.231739516,COF5=.00120858003,COF6=-536382e-11;return 1>xx?aleksUtil.math.lngamma(1+xx)-Math.log(xx):(x=xx-1,tmp=x+5.5,tmp-=(x+.5)*Math.log(tmp),ser=1+COF1/(x+1)+COF2/(x+2)+COF3/(x+3)+COF4/(x+4)+COF5/(x+5)+COF6/(x+6),-tmp+Math.log(2.50662827465*ser))},aleksUtil.math.logbeta=function(p,q){return aleksUtil.math.lngamma(p)+aleksUtil.math.lngamma(q)-aleksUtil.math.lngamma(p+q)},aleksUtil.math.betaCDF=function(x,pin,qin){var c,finsum,p,ps,q,term,xb,xi,y,dbetai,p1,i,n,ib,eps,alneps,sml,alnsml;if(0>=x)return 0;if(eps=1e-16,alneps=Math.log(eps),sml=eps,alnsml=alneps,y=x,p=pin,q=qin,(q>p||.8<=x)&&.2<=x&&(y=1-y,p=qin,q=pin),(p+q)*y/(p+1)<eps)dbetai=0,xb=p*Math.log(Math.max(y,sml))-Math.log(p)-aleksUtil.math.logbeta(p,q),xb>alnsml&&0!=y&&(dbetai=Math.exp(xb)),(y!=x||p!=pin)&&(dbetai=1-dbetai);else{if(ps=q-Math.floor(q),0==ps&&(ps=1),xb=p*Math.log(y)-Math.log(p)-aleksUtil.math.logbeta(ps,p),dbetai=0,xb>=alnsml&&(dbetai=Math.pow(Math.E,xb),term=dbetai*p,1!=ps)){n=Math.max(alneps/Math.log(y),4);for(var i=1;i<=n;i++)xi=i,term=term*(xi-ps)*y/xi,dbetai+=term/(p+xi)}if(1<q){xb=p*Math.log(y)+q*Math.log(1-y)-Math.log(q)-aleksUtil.math.logbeta(p,q),ib=Math.floor(Math.max(xb/alnsml,0)),term=Math.pow(Math.E,xb-ib*alnsml),c=1/(1-y),p1=q*c/(p+q-1),finsum=0,n=Math.floor(q),q==n&&n--;for(var i=1;i<=n&&!(1>=p1&&term/eps<=finsum);i++)xi=i,term=(q-xi+1)*c*term/(p+q-xi),1<term&&--ib,1<term&&(term*=sml),0==ib&&(finsum+=term);dbetai+=finsum}(y!=x||p!=pin)&&(dbetai=1-dbetai),dbetai=Math.max(Math.min(dbetai,1),0)}return dbetai},aleksUtil.math.gammaNormalApproximation=function(a,x){var p,sx;return 0>=x||0>=a?0:(sx=3*Math.sqrt(a)*(Math.pow(x/a,1/3)+1/(9*a)-1),aleksUtil.math.normalCDF(sx))},aleksUtil.math.gammaSeriesApproximation=function(a,x,gln){var p,sum,del,ap,n,done=!1;if(0>=x||0>=a)p=0;else{ap=a,del=1/a,sum=del;for(var n=1;!done&&1e3>n;n++)ap+=1,del*=x/ap,sum+=del,1e-14>Math.abs(del)&&(done=!0);p=sum*Math.pow(Math.E,-x+a*Math.log(x)-gln)}return p},aleksUtil.math.gammaFractionApproximation=function(a,x,gln){var g,anf,ana,an,a1,p,gold=0,fac=1,b1=1,b0=0,a0=1,done=!1;a1=x,p=0;for(var an=1;!done&&1e3>=an;an+=1)ana=an-a,a0=(a1+a0*ana)*fac,b0=(b1+b0*ana)*fac,anf=an*fac,a1=x*a0+anf*a1,b1=x*b0+anf*b1,0!=a1&&(fac=1/a1,g=b1*fac,1e-14>Math.abs((g-gold)/g)&&(p=Math.exp(-x+a*Math.log(x)-gln)*g,done=!0),gold=g);return p},aleksUtil.math.tCDF=function(x,df){if(!aleksUtil.isInt(df)||0>=df)return Number.NaN;var t,y,b,a,z,j,n,cdf,TWOVRPI=.6366197723675814,TOL=1e-6;if(n=df,z=1,t=x*x,y=t/n,b=1+y,!(n>Math.floor(n)||20<=n&&t<n||20<n)){if(20>n&&4>t)a=Math.sqrt(y),y=a,1==n&&(a=0);else{a=Math.sqrt(b),y=a*n;for(var j=2;Math.abs(a-z)>TOL;j+=2)z=a,y=y*(j-1)/(b*j),a+=y/(n+j);n+=2,z=0,y=0,a=-a}for(var n=n-2;1<n;n-=2)a=(n-1)/(b*n)*a+y;a=Math.abs(n)<TOL?a/Math.sqrt(b):TWOVRPI*(Math.atan(y)+a/b),cdf=z-a,cdf=0<x?1-.5*cdf:.5*cdf}else if(2>n&&1!=n){var dx,dp,da=.5,db=.5*n,ia=0,ib=Math.floor(db);dx=db/(db+da*t),dp=aleksUtil.math.betaCDF(dx,db,da),cdf=0<=x?1-.5*dp:.5*dp}else y>TOL&&(y=Math.log(b)),a=n-.5,b=48*a*a,y=a*y,y=(((((-.4*y-3.3)*y-24)*y-85.5)/(.8*y*y+100+b)+y+3)/b+1)*Math.sqrt(y),y=-1*y,cdf=aleksUtil.math.normalCDF(y),0<x&&(cdf=1-cdf);return cdf},aleksUtil.math.fCDF=function(x,df1,df2){return!aleksUtil.isInt(df1)||0>=df1||!aleksUtil.isInt(df2)||0>=df2?Number.NaN:+(1-aleksUtil.math.betaCDF(df2/(df2+df1*x),.5*df2,.5*df1)).toExponential(9)},aleksUtil.math.binomialCDF=function(n,p,c){if(Math.floor(n)!=n||0>=n||0>=p||1<=p)return Number.NaN;if(0>c)return 0;if(c==n)return 1;for(var res=0,f=1,k=0;k<=c;k++)res+=f*Math.pow(p,k)*Math.pow(1-p,n-k),f*=(n-k)/(k+1);return res},aleksUtil.math.normalQuantile=function(p){if(0>p||1<p)return Number.NaN;var q,r,ppn,split=.42,a0=2.50662823884,a1=-18.61500062529,a2=41.39119773534,a3=-25.44106049637,b1=-8.4735109309,b2=23.08336743743,b3=-21.06224101826,b4=3.13082909833,cc0=-2.78718931138,cc1=-2.29796479134,cc2=4.85014127135,cc3=2.3212127685,d1=3.54388924762,d2=1.63706781897;return q=p-.5,Math.abs(q)<=split?(r=q*q,ppn=q*(((a3*r+a2)*r+a1)*r+a0)/((((b4*r+b3)*r+b2)*r+b1)*r+1)):(r=p,0<q&&(r=1-p),r=Math.sqrt(-Math.log(r)),ppn=(((cc3*r+cc2)*r+cc1)*r+cc0)/((d2*r+d1)*r+1),0>q&&(ppn=-ppn)),ppn},aleksUtil.math.chisqQuantile=function(p,v){if(0>p||1<p||!aleksUtil.isInt(v)||0>=v)return Number.NaN;var ret_val,d_1,d_2,a,b,c,g,q,t,x,p1,p2,s1,s2,s3,s4,s5,s6,ch,xx,if1,aa=.6931471806,c1=.01,c2=.222222,c3=.32,c4=.4,c5=1.24,c6=2.2,c7=4.67,c8=6.66,c9=6.73,e=5e-7,c10=13.32,c11=60,c12=70,c13=84,c14=105,c15=120,c16=127,c17=140,c18=175,c19=210,c20=252,c21=264,c22=294,c23=346,c24=420,c25=462,c26=606,c27=672,c28=707,c29=735,c30=889,c31=932,c32=966,c33=1141,c34=1182,c35=1278,c36=1740,c37=2520,c38=5040,pmin=0,pmax=1;if(g=aleksUtil.math.lngamma(.5*v),ret_val=-1,xx=.5*v,c=xx-1,v<-c5*Math.log(p)){if(ch=Math.pow(p*xx*Math.pow(Math.E,g+xx*aa),1/xx),ch<e)return ret_val=ch,ret_val;}else if(v>c3)x=aleksUtil.math.normalQuantile(p),p1=c2/v,d_1=x*Math.sqrt(p1)+1-p1,ch=v*(d_1*d_1*d_1),ch>c6*v+6&&(ch=-2*(Math.log(1-p)-c*Math.log(.5*ch)+g));else{ch=c4,a=Math.log(1-p);do q=ch,p1=1+ch*(c7+ch),p2=ch*(c9+ch*(c8+ch)),d_1=-.5+(c7+2*ch)/p1,d_2=(c9+ch*(c10+3*ch))/p2,t=d_1-d_2,ch-=(1-Math.exp(a+g+.5*ch+c*aa)*p2/p1)/t;while(Math.abs(q/ch-1)>c1)}do q=ch,p1=.5*ch,p2=p-aleksUtil.math.gammaCDF(xx,p1),t=p2*Math.exp(xx*aa+g+p1-c*Math.log(ch)),b=t/ch,a=.5*t-b*c,s1=(c19+a*(c17+a*(c14+a*(c13+a*(c12+c11*a)))))/c24,s2=(c24+a*(c29+a*(c32+a*(c33+c35*a))))/c37,s3=(c19+a*(c25+a*(c28+c31*a)))/c37,s4=(c20+a*(c27+c34*a)+c*(c22+a*(c30+c36*a)))/c38,s5=(c13+c21*a+c*(c18+c26*a))/c37,s6=(c15+c*(c23+c16*c))/c38,d_1=s3-b*(s4-b*(s5-b*s6)),d_1=s1-b*(s2-b*d_1),ch+=t*(1+.5*t*s1-b*c*d_1);while(Math.abs(q/ch-1)>e);return ret_val=ch,ret_val},aleksUtil.math.betaQuantile=function(alpha,p,q){var beta,ret_val,d_1,d_2,indx,prev,a,g,h,r,s,t,w,y,yprev,pp,qq,sq,tx,adj,acu,iex,fpu,xin;if(beta=aleksUtil.math.logbeta(p,q),fpu=-30*10,ret_val=alpha,0>=p||0>=q)return ret_val;if(0==alpha||1==alpha)return ret_val;.5>=alpha?(a=alpha,pp=p,qq=q,indx=!1):(a=1-alpha,pp=q,qq=p,indx=!0),r=Math.sqrt(-Math.log(a*a)),y=r-(.27061*r+2.30753)/(1+(.04481*r+.99229)*r),1<pp&&1<qq?(r=(y*y-3)/6,s=1/(pp+pp-1),t=1/(qq+qq-1),h=2/(s+t),d_1=y*Math.sqrt(h+r)/h,d_2=(t-s)*(r+5/6-2/(3*h)),w=d_1-d_2,ret_val=pp/(pp+qq*Math.exp(w+w))):(r=qq+qq,t=1/(9*qq),d_1=1-t+y*Math.sqrt(t),t=r*(d_1*d_1*d_1),0>=t?ret_val=1-Math.exp((Math.log((1-a)*qq)+beta)/qq):(t=(4*pp+r-2)/t,ret_val=1>=t?Math.exp((Math.log(a*pp)+beta)/pp):1-2/(t+1))),r=1-pp,t=1-qq,yprev=0,sq=1,prev=1,1e-4>ret_val&&(ret_val=1e-4),.9999<ret_val&&(ret_val=.9999),d_1=-5/(pp*pp)-1/(a*a)-13,iex=-30>d_1?-30:d_1,acu=Math.pow(10,iex);do{y=aleksUtil.math.betaCDF(ret_val,pp,qq),xin=ret_val,y=(y-a)*Math.exp(beta+r*Math.log(xin)+t*Math.log(1-xin)),0>=y*yprev&&(prev=sq>fpu?sq:fpu),g=1;do{if(adj=g*y,sq=adj*adj,sq<prev&&(tx=ret_val-adj,0<=tx&&1>=tx)){if(prev<=acu||y*y<=acu)return indx&&(ret_val=1-ret_val),ret_val;if(0!=tx&&1!=tx)break}g/=3}while(!0);if(tx==ret_val)return indx&&(ret_val=1-ret_val),ret_val;ret_val=tx,yprev=y}while(!0)},aleksUtil.math.tQuantile=function(pp,n){if(0>pp||1<pp||!aleksUtil.isInt(n)||0>=n)return Number.NaN;var sq,p,a,b,c,d,x,y;return p=.5>pp?2*pp:2*(1-pp),3>=n?1==n?sq=aleksUtil.math.tan(Math.PI/2*(1-p)):2==n?sq=Math.sqrt(2/(p*(2-p))-2):(sq=aleksUtil.math.betaQuantile(p,.5*n,.5),0!=sq&&(sq=Math.sqrt(n/sq-n))):(a=1/(n-.5),b=48/(a*a),c=((20700*a/b-98)*a-16)*a+96.36,d=((94.5/(b+c)-3)/b+1)*Math.sqrt(a*Math.PI/2)*n,x=d*p,y=Math.pow(x,2/n),y>.05+a?(x=aleksUtil.math.normalQuantile(.5*p),y=x*x,5>n&&(c+=.3*(n-4.5)*(x+.6)),c=(((.05*d*x-5)*x-7)*x-2)*x+b+c,y=(((((.4*y+6.3)*y+36)*y+94.5)/c-y-3)/b+1)*x,y=a*y*y,y=.002<y?Math.pow(Math.E,y)-1:.5*y*y+y):y=((1/(3*(((n+6)/(n*y)-.089*d-.822)*(n+2)))+.5/(n+4))*y-1)*(n+1)/(n+2)+1/y,sq=Math.sqrt(n*y)),.5>pp&&(sq=-sq),sq},aleksUtil.math.fQuantile=function(p,df1,df2){if(0>p||1<p||!aleksUtil.isInt(df1)||0>=df1||!aleksUtil.isInt(df2)||0>=df2)return Number.NaN;var dx;return 0==p?0:(dx=aleksUtil.math.betaQuantile(1-p,.5*df2,.5*df1),df2*(1/dx-1)/df1)},aleksUtil.math.getElements0NPermutations=function(elements,size,minsize){for(var permutations=[],i=minsize;i<=size;i++)permutations=permutations.concat(aleksUtil.math.getElementsNPermutations(elements,i));return permutations},aleksUtil.math.getElementsNPermutations=function(elements,size){if(0==size)return[];for(var targetElement,array=[],i=0;i<elements.length;i++)if(targetElement=elements[i],1==size)array.push([targetElement]);else{var subArray=elements.slice(0);subArray.splice(i);for(var targetArray=aleksUtil.math.getElementsNPermutations(subArray,size-1),j=0;j<targetArray.length;j++)targetArray[j].unshift(targetElement);array=array.concat(targetArray)}return array},function(){var DUMMY_VARIABLE="DUMMY_VARIABLE",TOLERANCE=1e-7;aleksUtil.math.Polynomial=function(termList){this.terms=[],this.variableList=[];for(var monomial,sanitizedTermList=termList||[],i=0;i<sanitizedTermList.length;i++)monomial=new __Monomial(sanitizedTermList[i].coefficient,sanitizedTermList[i].degrees),this.terms.push(monomial),__addVariablesToList.call(this,monomial.variableList);this.terms.sort(__compareMonomials),this.initialize()},aleksUtil.math.Polynomial.prototype.initialize=function(){__simplify.call(this)},aleksUtil.math.Polynomial.prototype.getLargestDegree=function(){for(var totalDegree,maxDegree=0,i=0;i<this.terms.length;i++)totalDegree=this.terms[i].getTotalDegree(),totalDegree>maxDegree&&(maxDegree=totalDegree);return maxDegree},aleksUtil.math.Polynomial.prototype.multiplyByConstant=function(c){for(var returnPolynomial=this.clone(),i=0;i<returnPolynomial.terms.length;i++)returnPolynomial.terms[i].coefficient*=c;return returnPolynomial},aleksUtil.math.Polynomial.prototype.isPolynomialZero=function(){return!this.terms||0==this.terms.length},aleksUtil.math.Polynomial.prototype.clone=function(){return aleksUtil.math.addPolynomials(new aleksUtil.math.Polynomial,this)},aleksUtil.math.Polynomial.prototype.toString=function(){for(var stringArray=[],i=0;i<this.terms.length;i++)stringArray.push(this.terms[i].toString(!0));return stringArray.join("")},aleksUtil.math.Polynomial.prototype.getContent=function(){if(!Number.isInteger(this.terms[0].coefficient))return 0;for(var content=this.terms[0].coefficient,i=1;i<this.terms.length;i++)if(Number.isInteger(this.terms[i].coefficient))content=aleksUtil.math.gcd(content,this.terms[i].coefficient);else return 0;;return content},aleksUtil.math.Polynomial.prototype.equals=function(f){if(!f||this.terms.length!=f.terms.length)return!1;for(var i=0;i<this.terms.length;i++)if(!this.terms[i].equals(f.terms[i]))return!1;return!0},aleksUtil.math.addPolynomials=function(f,g){for(var resultPolynomial=new aleksUtil.math.Polynomial,i=0;i<f.terms.length;i++)__addMonomial.call(resultPolynomial,f.terms[i]);for(var i=0;i<g.terms.length;i++)__addMonomial.call(resultPolynomial,g.terms[i]);return resultPolynomial.initialize(),resultPolynomial},aleksUtil.math.subtractPolynomials=function(f,g){for(var resultPolynomial=new aleksUtil.math.Polynomial,i=0;i<f.terms.length;i++)__addMonomial.call(resultPolynomial,f.terms[i]);for(var negativeMonomial,i=0;i<g.terms.length;i++)negativeMonomial=g.terms[i].clone(),negativeMonomial.coefficient*=-1,__addMonomial.call(resultPolynomial,negativeMonomial,!0);return resultPolynomial.initialize(),resultPolynomial},aleksUtil.math.multiplyPolynomials=function(f,g){for(var resultPolynomial=new aleksUtil.math.Polynomial,i=0;i<f.terms.length;i++)for(var productMonomial,j=0;j<g.terms.length;j++)productMonomial=__monomialMultiply(f.terms[i],g.terms[j]),__addMonomial.call(resultPolynomial,productMonomial);return resultPolynomial.initialize(),resultPolynomial},aleksUtil.math.getSPolynomial=function(f,g){var leadingTermLeastCommonMultiple=__monomialLCM(__getLeadingMonomial.call(f),__getLeadingMonomial.call(g)),fMultiplier=new aleksUtil.math.Polynomial([__monomialDivide(leadingTermLeastCommonMultiple,__getLeadingMonomial.call(f))]),gMultiplier=new aleksUtil.math.Polynomial([__monomialDivide(leadingTermLeastCommonMultiple,__getLeadingMonomial.call(g))]);return aleksUtil.math.subtractPolynomials(aleksUtil.math.multiplyPolynomials(fMultiplier,f),aleksUtil.math.multiplyPolynomials(gMultiplier,g))},aleksUtil.math.generalizedPolynomialDivision=function(f,G){for(var remainderPolynomial=new aleksUtil.math.Polynomial,quotients=[],i=0;i<G.length;i++)quotients.push(new aleksUtil.math.Polynomial);;for(var intermediatePolynomial=f,n=0;!intermediatePolynomial.isPolynomialZero()&&1e3>n;){for(var i=0,dividing=!1;i<G.length&&!dividing;)if(__monomialCanDivide(__getLeadingMonomial.call(intermediatePolynomial),__getLeadingMonomial.call(G[i]))){var intermediateQuotient=new aleksUtil.math.Polynomial([__monomialDivide(__getLeadingMonomial.call(intermediatePolynomial),__getLeadingMonomial.call(G[i]))]);quotients[i]=aleksUtil.math.addPolynomials(quotients[i],intermediateQuotient),intermediatePolynomial=aleksUtil.math.subtractPolynomials(intermediatePolynomial,aleksUtil.math.multiplyPolynomials(intermediateQuotient,G[i])),dividing=!0}else i++;if(!dividing){var leadingTerm=new aleksUtil.math.Polynomial([__getLeadingMonomial.call(intermediatePolynomial)]);remainderPolynomial=aleksUtil.math.addPolynomials(remainderPolynomial,leadingTerm),intermediatePolynomial=aleksUtil.math.subtractPolynomials(intermediatePolynomial,leadingTerm)}n++}return{quotients:quotients,remainder:remainderPolynomial}},aleksUtil.math.euclideanPolynomialDivision=function(dividend,divisor){var generalizedDivisionResult=aleksUtil.math.generalizedPolynomialDivision(dividend,[divisor]);return{quotient:generalizedDivisionResult.quotients[0],remainder:generalizedDivisionResult.remainder}},aleksUtil.math.getGrobnerBases=function(F){for(var grobnerBases=[],i=0;i<F.length;i++)grobnerBases.push(F[i].clone());for(var remainingPairs=[],i=0;i<F.length;i++)for(var j=i+1;j<F.length;j++)remainingPairs.push([i,j]);for(var n=0;0<remainingPairs.length&&1e3>n;){var pair=remainingPairs.pop(),sPolynomial=aleksUtil.math.getSPolynomial(grobnerBases[pair[0]],grobnerBases[pair[1]]),remainder=aleksUtil.math.generalizedPolynomialDivision(sPolynomial,grobnerBases).remainder;if(!remainder.isPolynomialZero()){for(var i=0;i<grobnerBases.length;i++)remainingPairs.push([i,grobnerBases.length]);grobnerBases.push(remainder)}n++}return grobnerBases},aleksUtil.math.getPolynomialLCM=function(f,g){var dummyDegrees={};dummyDegrees[DUMMY_VARIABLE]=1;var dummyVariablePolynomial=new aleksUtil.math.Polynomial([{coefficient:1,degrees:dummyDegrees}]),oneMinusDummyVariablePolynomial=new aleksUtil.math.Polynomial([{coefficient:1},{coefficient:-1,degrees:dummyDegrees}]),dummyVariableTimesF=aleksUtil.math.multiplyPolynomials(dummyVariablePolynomial,f),oneMinusDummyVariableTimesG=aleksUtil.math.multiplyPolynomials(oneMinusDummyVariablePolynomial,g),grobnerBases=aleksUtil.math.getGrobnerBases([dummyVariableTimesF,oneMinusDummyVariableTimesG]),normalizedLCM=grobnerBases[grobnerBases.length-1].multiplyByConstant(1/__getLeadingMonomial.call(grobnerBases[grobnerBases.length-1]).coefficient);return normalizedLCM},aleksUtil.math.getPolynomialGCD=function(f,g){var fTimesG=aleksUtil.math.multiplyPolynomials(f,g),lcm=aleksUtil.math.getPolynomialLCM(f,g),gcd=aleksUtil.math.generalizedPolynomialDivision(fTimesG,[lcm]);if(gcd.quotients[0].isPolynomialZero())var normalizedGCD=new aleksUti.math.Polynomial({coefficient:1});else var normalizedGCD=gcd.quotients[0].multiplyByConstant(1/__getLeadingMonomial.call(gcd.quotients[0]).coefficient);return normalizedGCD};var __addMonomial=function(monomial,dontClone){var myMonomial={};if(myMonomial=dontClone?monomial:monomial.clone(),0==this.terms.length)this.terms.push(myMonomial),__addVariablesToList.call(this,myMonomial.variableList);else{for(var monomialAdded=!1,i=0;i<this.terms.length;i++)if(0>__compareMonomials(myMonomial,this.terms[i])){monomialAdded=!0,this.terms.splice(i,0,myMonomial),__addVariablesToList.call(this,myMonomial.variableList);break}else if(0===__compareMonomials(myMonomial,this.terms[i])){monomialAdded=!0,this.terms[i].coefficient+=myMonomial.coefficient;break}!monomialAdded&&(this.terms.push(myMonomial),__addVariablesToList.call(this,myMonomial.variableList))}},__addVariablesToList=function(variableList){for(var appendVar,i=0;i<variableList.length;i++){appendVar=!0;for(var j=0;j<this.variableList.length;j++)if(variableList[i]==this.variableList[j]){appendVar=!1;break}else if(variableList[i]<this.variableList[j]){appendVar=!1,this.variableList.splice(j,0,variableList[i]);break}appendVar&&this.variableList.push(variableList[i])}},__simplify=function(){for(var i=this.terms.length-1;1<=i;i--)!this.terms[i].coefficient||aleksUtil.math.approximatelyEqual(this.terms[i].coefficient,0,TOLERANCE)?this.terms.splice(i,1):0===__compareMonomials(this.terms[i-1],this.terms[i])&&(this.terms[i-1].coefficient+=this.terms[i].coefficient,this.terms.splice(i,1),aleksUtil.math.approximatelyEqual(this.terms[i-1].coefficient,0,TOLERANCE)&&(this.terms.splice(i-1,1),i--));0<this.terms.length&&aleksUtil.math.approximatelyEqual(this.terms[0].coefficient,0,TOLERANCE)&&this.terms.shift()},__getLeadingMonomial=function(){return this.terms[this.terms.length-1]},__Monomial=function(coefficient,degrees){var myDegrees=degrees||{};this.coefficient=coefficient||1,this.degrees=JSON.parse(JSON.stringify(myDegrees)),this.variableList=Object.keys(this.degrees).sort(__compareVariables)};__Monomial.prototype.getTotalDegree=function(){var totalDegree=0;for(var variable in this.degrees)totalDegree+=this.degrees[variable];return totalDegree},__Monomial.prototype.clone=function(){return new __Monomial(this.coefficient,this.degrees)},__Monomial.prototype.toString=function(alwaysDisplaySign){var stringArray=[];alwaysDisplaySign&&0<=this.coefficient&&stringArray.push("+"),stringArray.push(this.coefficient+"");for(var i=0;i<this.variableList.length;i++)stringArray.push(this.variableList[i]),stringArray.push("^"),stringArray.push(this.degrees[this.variableList[i]]+"");return stringArray.join("")},__Monomial.prototype.equals=function(a){return!!a&&!!aleksUtil.math.approximatelyEqual(this.coefficient,a.coefficient,TOLERANCE)&&!(0!==__compareMonomials(this,a))};var __monomialCanDivide=function(dividend,divisor){for(var variable in divisor.degrees)if(divisor.degrees[variable]&&(!dividend.degrees[variable]||dividend.degrees[variable]<divisor.degrees[variable]))return!1;return!0},__addDegrees=function(degrees1,degrees2){var result={};for(var variable in degrees1)result[variable]=degrees1[variable];for(var variable in degrees2)result[variable]?result[variable]+=degrees2[variable]:result[variable]=degrees2[variable];return result},__subtractDegrees=function(degrees1,degrees2){var result={};for(var variable in degrees1)if(!degrees2[variable])result[variable]=degrees1[variable];else{var powerDifference=degrees1[variable]-degrees2[variable];0<powerDifference&&(result[variable]=powerDifference)}return result},__monomialMultiply=function(a,b){var newCoefficient=aleksUtil.math.times(a.coefficient,b.coefficient),newDegrees=__addDegrees(a.degrees,b.degrees);return new __Monomial(newCoefficient,newDegrees)},__monomialDivide=function(a,b){var newCoefficient=aleksUtil.math.div(a.coefficient,b.coefficient),newDegrees=__subtractDegrees(a.degrees,b.degrees);return new __Monomial(newCoefficient,newDegrees)},__monomialLCM=function(a,b){var newDegrees={};for(var variable in a.degrees)newDegrees[variable]=!b.degrees[variable]||a.degrees[variable]>=b.degrees[variable]?a.degrees[variable]:b.degrees[variable];for(var variable in b.degrees)a.degrees[variable]||(newDegrees[variable]=b.degrees[variable]);return new __Monomial(1,newDegrees)},__compareMonomials=function(a,b){for(var i=0;i<a.variableList.length&&i<b.variableList.length;)if(a.variableList[i]==DUMMY_VARIABLE&&b.variableList[i]==DUMMY_VARIABLE){if(a.degrees[a.variableList[i]]<b.degrees[b.variableList[i]])return 1;if(a.degrees[a.variableList[i]]>b.degrees[b.variableList[i]])return-1;i++;continue}else{if(a.variableList[i]==DUMMY_VARIABLE)return 1;if(b.variableList[i]==DUMMY_VARIABLE)return-1;if(a.variableList[i]>b.variableList[i])return-1;if(a.variableList[i]<b.variableList[i])return 1;if(a.degrees[a.variableList[i]]>b.degrees[b.variableList[i]])return 1;if(a.degrees[a.variableList[i]]<b.degrees[b.variableList[i]])return-1;i++}return i<a.variableList.length?1:i<b.variableList.length?-1:0},__compareVariables=function(x,y){return x==DUMMY_VARIABLE&&y==DUMMY_VARIABLE?0:x==DUMMY_VARIABLE?-1:y==DUMMY_VARIABLE?1:x>y?1:x<y?-1:0}}(),function(){aleksUtil.math.compareFunctions=function(givenFunction1,givenFunction2,getter1,getter2,params){if(!givenFunction1||!givenFunction2||!getter1||!getter2)throw new TypeError("Please provide two function objects and two getters as arguments.");params=params||{};var function1=new __FunctionObject(givenFunction1,getter1),function2=new __FunctionObject(givenFunction2,getter2);return params.tol=params.tol||1e-7,params.epsilon=params.epsilon||1e-16,params.trials=params.trials||10,params.maxFails=params.maxFails||3,params.passNumber=params.passNumber||5,params.varList=params.varList||["x"],params.domain=params.domain||[-10,10],__evalExpressions(function1,function2,params)};var __evalExpressions=function(function1,function2,params){for(var result={match:!1,oppositeMatch:!1,ratioMatch:!1,constantDifferenceMatch:!1,inverseMatch:!1,constantDifference:Number.NaN,ratio:Number.NaN,inverseRatioMatch:!1,inverseRatio:Number.NaN,linearRelation:!1,slope:Number.NaN,yIntercept:Number.NaN,badDomain:!1},names=params.varList,testPoints=[],i=0;i<names.length;i++){testPoints.push([]);for(var j=0;j<params.trials;j++)testPoints[i].push((params.domain[1]-params.domain[0])*Math.random()+params.domain[0])}for(var variableValues,functionEvaluation1=Number.NaN,functionEvaluation2=Number.NaN,domainDiff=0,differences=[],sums=[],ratios=[],products=[],function1Values=[],function2Values=[],j=0;j<params.trials;j++){variableValues={};for(var i=0;i<names.length;i++)variableValues[names[i]]=testPoints[i][j];if(functionEvaluation1=function1.getValue(variableValues),functionEvaluation2=function2.getValue(variableValues),params.noComplex&&(functionEvaluation1=+functionEvaluation1,functionEvaluation2=+functionEvaluation2),!(aleksUtil.math.getEuclideanNorm(functionEvaluation1)<1/0)||!(aleksUtil.math.getEuclideanNorm(functionEvaluation2)<1/0)){if((aleksUtil.math.getEuclideanNorm(functionEvaluation1)<1/0||aleksUtil.math.getEuclideanNorm(functionEvaluation2)<1/0)&&(domainDiff++,3<domainDiff))break;continue}differences.push(aleksUtil.math.minus(functionEvaluation2,functionEvaluation1)),sums.push(aleksUtil.math.plus(functionEvaluation2,functionEvaluation1)),ratios.push(aleksUtil.math.div(functionEvaluation1,functionEvaluation2)),products.push(aleksUtil.math.times(functionEvaluation1,functionEvaluation2)),function1Values.push(functionEvaluation1),function2Values.push(functionEvaluation2)}if(3<domainDiff)result.badDomain=!0;else if(__match(differences,function2Values,params))result.match=!0,result.ratioMatch=!0,result.constantDifferenceMatch=!0,result.ratio=1,result.constantDifference=0,result.linearRelation=!0,result.slope=1,result.yIntercept=0;else if(__oppositeMatch(sums,function2Values,params))result.oppositeMatch=!0,result.ratioMatch=!0,result.ratio=-1,result.linearRelation=!0,result.slope=-1,result.yIntercept=0;else if(__inverseMatch(products,params))result.inverseMatch=!0,result.inverseRatioMatch=!0,result.inverseRatio=1;else if(__ratioMatch(ratios,params))result.ratioMatch=!0,result.ratio=ratios[0],result.linearRelation=!0,result.slope=ratios[0],result.yIntercept=0;else if(__constantDifferenceMatch(differences,function2Values,params))result.constantDifferenceMatch=!0,result.constantDifference=differences[0],result.linearRelation=!0,result.slope=1,result.yIntercept=differences[0];else if(__ratioMatch(products,params))result.inverseRatioMatch=!0,result.inverseRatio=products[0];else{var linearRelationInfo=__checkLinearRelation(function1Values,function2Values,params);linearRelationInfo.linearRelation&&(result.linearRelation=!0,result.slope=linearRelationInfo.slope,result.yIntercept=linearRelationInfo.yIntercept)}return result},__match=function(differences,functionValues,params){for(var matchCount=0,failCount=0,match=!1,i=0;i<differences.length&&(aleksUtil.math.div(aleksUtil.math.getEuclideanNorm(differences[i]),Math.max(aleksUtil.math.getEuclideanNorm(functionValues[i]),params.epsilon))<params.tol?matchCount++:failCount++,!(failCount>params.maxFails));i++);return failCount<=params.maxFails&&matchCount>=params.passNumber&&(match=!0),match},__oppositeMatch=function(sums,functionValues,params){for(var oppositeMatchCount=0,failCount=0,oppositeMatch=!1,i=0;i<sums.length&&(aleksUtil.math.div(aleksUtil.math.getEuclideanNorm(sums[i]),Math.max(aleksUtil.math.getEuclideanNorm(functionValues[i]),params.epsilon))<params.tol?oppositeMatchCount++:failCount++,!(failCount>params.maxFails));i++);return failCount<=params.maxFails&&oppositeMatchCount>=params.passNumber&&(oppositeMatch=!0),oppositeMatch},__inverseMatch=function(products,params){for(var inverseMatchCount=0,failCount=0,inverseMatch=!1,i=0;i<products.length&&(aleksUtil.math.getEuclideanNorm(aleksUtil.math.minus(products[i],1))<params.tol?inverseMatchCount++:failCount++,!(failCount>params.maxFails));i++);return failCount<=params.maxFails&&inverseMatchCount>=params.passNumber&&(inverseMatch=!0),inverseMatch},__ratioMatch=function(ratios,params){for(var ratioMatchCount=0,failCount=0,ratioMatch=!1,ratio=ratios[0],i=0;i<ratios.length&&(aleksUtil.math.getEuclideanNorm(aleksUtil.math.minus(ratios[i],ratio))<params.tol?ratioMatchCount++:failCount++,!(failCount>params.maxFails));i++);return failCount<=params.maxFails&&ratioMatchCount>=params.passNumber&&(ratioMatch=!0),ratioMatch},__constantDifferenceMatch=function(differences,functionValues,params){for(var constantDifferenceMatchCount=0,failCount=0,constantDifferenceMatch=!1,difference=differences[0],i=0;i<differences.length&&(aleksUtil.math.div(aleksUtil.math.getEuclideanNorm(aleksUtil.math.minus(differences[i],difference)),Math.max(aleksUtil.math.getEuclideanNorm(functionValues[i]),params.epsilon))<params.tol?constantDifferenceMatchCount++:failCount++,!(failCount>params.maxFails));i++);return failCount<=params.maxFails&&constantDifferenceMatchCount>=params.passNumber&&(constantDifferenceMatch=!0),constantDifferenceMatch},__checkLinearRelation=function(function1Values,function2Values,params){var returnObject={linearRelation:!1,slope:Number.NaN,yIntercept:Number.NaN};if(2<function1Values.length&&function2Values.length==function1Values.length){for(var currentSlopeIntercept,slopeIntercept=__getSlopeIntercept(function2Values[0],function2Values[1],function1Values[0],function1Values[1]),foundMismatch=!1,i=2;i<function1Values.length;i++)if(currentSlopeIntercept=__getSlopeIntercept(function2Values[i-1],function2Values[i],function1Values[i-1],function1Values[i]),aleksUtil.math.getEuclideanNorm(aleksUtil.math.minus(currentSlopeIntercept.slope,slopeIntercept.slope))>params.tol||aleksUtil.math.getEuclideanNorm(aleksUtil.math.minus(currentSlopeIntercept.yIntercept,slopeIntercept.yIntercept))>params.tol){foundMismatch=!0;break}!foundMismatch&&(returnObject.linearRelation=!0,returnObject.slope=slopeIntercept.slope,returnObject.yIntercept=slopeIntercept.yIntercept)}return returnObject},__getSlopeIntercept=function(x1,x2,y1,y2){var slope=aleksUtil.math.div(aleksUtil.math.minus(y2,y1),aleksUtil.math.minus(x2,x1)),yIntercept=aleksUtil.math.minus(y1,aleksUtil.math.times(slope,x1));return{slope:slope,yIntercept:yIntercept}},__FunctionObject=function(functionObject,getter){this._functionObject=functionObject,this._getter=getter};__FunctionObject.prototype.getValue=function(values){return this._getter(this._functionObject,values)}}(),aleksUtil.chem={},aleksUtil.chem.checkAnswerBoundaries=function(studentAnswer,correctAnswer,sigDigits,studentSigDigits){if(!(aleksUtil.math.sign(studentAnswer,!0)!=aleksUtil.math.sign(correctAnswer,!0)||1>sigDigits)){if(studentAnswer==correctAnswer)return!0;var correctAnswer=Math.abs(correctAnswer),studentAnswer=Math.abs(studentAnswer);if(0==correctAnswer){if(studentAnswer*=Math.pow(10,sigDigits-1),0==Math.round(studentAnswer))return!0;}else if(!studentSigDigits||studentSigDigits>=sigDigits){var roundedStudentAnswer=+aleksUtil.math.toExponential(studentAnswer,sigDigits-1),roundedAnswer=+aleksUtil.math.toExponential(correctAnswer,sigDigits-1),imprecision=aleksUtil.math.pow(10,+aleksUtil.math.toExponential(correctAnswer,sigDigits-1).match(/e(\+|-)\d+/g)[0].replace(/e/,"")-sigDigits+1);if(3<=sigDigits&&roundedStudentAnswer>=aleksUtil.math.minus(roundedAnswer,imprecision)&&roundedStudentAnswer<=aleksUtil.math.plus(roundedAnswer,imprecision))return!0;if(3>sigDigits){var errorMargin=.5*imprecision,lowAnswer=+aleksUtil.math.toExponential(aleksUtil.math.minus(correctAnswer,errorMargin),sigDigits-1),highAnswer=+aleksUtil.math.toExponential(aleksUtil.math.plus(correctAnswer,errorMargin),sigDigits-1);if(roundedStudentAnswer>=lowAnswer&&roundedStudentAnswer<=highAnswer)return!0}}else{var roundedStudentAnswer=+aleksUtil.math.toExponential(studentAnswer,studentSigDigits-1),roundedAnswer=+aleksUtil.math.toExponential(correctAnswer,studentSigDigits-1);if(roundedStudentAnswer==roundedAnswer)return!0}return!1}},aleksUtil.popup={popupID:0,popupList:[]};var realPeriodicTable=void 0,ptHasContent=!1;aleksUtil.popup.createPopup=function(popupInnerHTML,params){if(window.nav_button_html){!params&&(params={});var popupID=aleksUtil.popup.popupID;aleksUtil.popup.popupID++;var newPopupFrame=null;if(smtIsNewStudentModule()){var popupWindow=null;popupWindow=params.popupType&&"calculator"==params.popupType?new smt.CalcWindow:"tabedChoiceGeom"==params.popupType?new smt.PopupChoiceMenuWindow({title:params.popupTitle}):new smt.PeriodicTable({isInTutorial:params.isInTutorial});var popupInnerDiv=document.createElement("div");popupInnerDiv.innerHTML=popupInnerHTML,popupWindow.setWindowMainContent(popupInnerDiv);var newPopupFrame=popupWindow.getDOMElement();newPopupFrame.id="aleksPopup"+popupID}else{var newPopupFrame=document.createElement("div");newPopupFrame.id="aleksPopup"+popupID,newPopupFrame.className=params.popupClass?params.popupClass:params.useShadow?"ALEKSTool_popup_frame_shadowed":"ALEKSTool_popup_frame";var popupTitle=params.popupTitle?params.popupTitle:"",titleBarHeight=22,titleBarPadding=0+(params.popupNoCloseButton?0:32)+(params.popupMinimizeButton?32:0),titleBarHTML="<div id='aleksPopup"+popupID+"_titlebar' class='ALEKSTool_popup_titlebar' style='height:"+titleBarHeight+"px;'><div style='padding-left:7px;padding-right:"+titleBarPadding+"px;height:"+titleBarHeight+"px;line-height:"+titleBarHeight+"px;'>"+popupTitle+"</div></div>";if(!params.popupNoCloseButton){var closeButton=nav_button_html("aleksPopup"+popupID+"_closeButton","ALEKSTool_popup_closebutton",1,"aleksUtil.popup.closePopup("+popupID+");","x");titleBarHTML+="<div class='ALEKSTool_popup_titlebar_closebutton' style='height:"+titleBarHeight+"px;'><div class='ALEKSTool_popup_titlebar_closebutton_inner' style='height:"+(titleBarHeight+2)+"px;'>"+closeButton[0].join("")+"</div></div>"}if(params.popupMinimizeButton){var minimizeButton=nav_button_html("aleksPopup"+popupID+"_minimizeButton","ALEKSTool_popup_minimizebutton",1,"aleksUtil.popup.minimizePopup("+popupID+");","_");titleBarHTML+="<div style='position:absolute;top:0px;right:31px;width:20px;height:"+titleBarHeight+"px;background-color:red;z-index:1;border-left:1px solid black;overflow:hidden;'><div style='position:absolute;top:-1px;left:-1px;width:22px;height:"+(titleBarHeight+2)+"px;'>"+minimizeButton[0].join("")+"</div></div>"}titleBarHTML+="<div style='position:relative;width:1px;height:"+titleBarHeight+"px;'></div>",newPopupFrame.innerHTML=titleBarHTML;var newPopupContent=document.createElement("div");newPopupContent.id="aleksPopup"+popupID+"_content",newPopupContent.className="ALEKSTool_popup_content",aleksUtil.DOM.setCSSStyle(newPopupContent,"position:relative;top:0px;left:0px;"),newPopupFrame.appendChild(newPopupContent),newPopupContent.innerHTML=popupInnerHTML,document.body.insertBefore(newPopupFrame,document.body.firstChild),aleksUtil.DOM.disableSelection(di("aleksPopup"+popupID+"_titlebar"));var titlebar=di("aleksPopup"+popupID+"_titlebar");if("true"==params.popupFullDrag){var titlebar=newPopupFrame;di("aleksPopup"+popupID+"_titlebar").style.cursor="pointer",aleksUtil.DOM.disableSelection(newPopupFrame),closeButton&&emgr2.addEventListener(di("aleksPopup"+popupID+"_closeButton"),"mousedown",function(){aleksUtil.popup.doNotDragAtNextMouseDown=!0})}if(global.isTablet?emgr2.addEventListener(titlebar,"touchstart",function(e){aleksUtil.popup.startPopupDrag(e,popupID)}):(emgr2.addEventListener(titlebar,"mousedown",function(e){aleksUtil.popup.startPopupDrag(e,popupID)}),emgr2.addEventListener(newPopupContent,"mousedown",function(e){aleksUtil.popup.raisePopup(popupID)}),emgr2.addEventListener(document,"mouseout",aleksUtil.popup.eventOnMouseOutDocument),emgr2.addEventListener(document.body,"mouseleave",aleksUtil.popup.eventOnMouseOutDocument)),titlebar.style.cursor="pointer",closeButton)for(var i=0;i<closeButton[1].length;i++)setTimeout("cmsCButton('"+closeButton[1][i][0]+"','"+closeButton[1][i][3]+"','"+closeButton[1][i][1]+"',"+closeButton[1][i][2]+")",1);if(minimizeButton)for(var i=0;i<minimizeButton[1].length;i++)setTimeout("cmsCButton('"+minimizeButton[1][i][0]+"','"+minimizeButton[1][i][3]+"','"+minimizeButton[1][i][1]+"',"+minimizeButton[1][i][2]+")",1)}var popupParameters={};if(popupParameters.popupFrame=newPopupFrame,popupParameters.popupCloseFunction=params.popupCloseFunction,popupParameters.popupCloseFunctionObject=params.popupCloseFunctionObject,popupParameters.popupIsMinimized=!1,popupParameters.keepPopupOnScreen=params.keepPopupOnScreen,popupParameters.popupFullDrag=params.popupFullDrag,popupParameters.popupID=popupID,aleksUtil.popup.popupList.push(popupParameters),aleksUtil.popup.raisePopup(popupID),params.popupDefaultPosition){var my_left=0,my_top=0,dim=getWindowWidthHeight(),dimDiv=getPopupHTMLWidthHeight(popupInnerHTML);("top"==params.popupDefaultPosition||"center"==params.popupDefaultPosition)&&(my_left=parseInt(dim[0]/2-dimDiv[0]/2+document.getElementsByTagName("body").item(0).scrollLeft)),"center"==params.popupDefaultPosition?my_top=Math.max(0,parseInt(dim[1]/2-dimDiv[1]/2+getScroll())):"top"==params.popupDefaultPosition&&(my_top=Math.max(0,parseInt(getScroll()))),params.popupPosition=[my_left,my_top]}if(params.popupPosition&&(newPopupFrame.style.left=params.popupPosition[0]+"px",newPopupFrame.style.top=params.popupPosition[1]+"px"),params.popupDisplay&&(newPopupFrame.style.display=params.popupDisplay),smtIsNewStudentModule())if(params.popupType&&"calculator"==params.popupType);else return"tabedChoiceGeom"==params.popupType&&popupWindow.show(),newPopupFrame;return newPopupFrame}},aleksUtil.popup.closePopup=function(popupID){popupID=""+popupID,popupID=popupID.replace(/^aleksPopup/,"");var targetPopup=di("aleksPopup"+popupID),popupCloseFunction=aleksUtil.popup.popupList[popupID].popupCloseFunction,popupCloseFunctionObject=aleksUtil.popup.popupList[popupID].popupCloseFunctionObject?aleksUtil.popup.popupList[popupID].popupCloseFunctionObject:global;popupCloseFunction?popupCloseFunction.apply(popupCloseFunctionObject,[popupID]):targetPopup.parentNode.removeChild(targetPopup)},aleksUtil.popup.getPopupDOMCloseButton=function(targetPopup){if("object"==typeof targetPopup&&targetPopup.id)var popupID=targetPopup.id.replace(/^aleksPopup/,"");else var popupID=targetPopup;return di("aleksPopup"+popupID+"_closeButton")},aleksUtil.popup.raisePopup=function(popupID){for(var targetPopup,popupID=+popupID,i=0;i<aleksUtil.popup.popupList.length;i++)targetPopup=di("aleksPopup"+i),targetPopup&&(i==popupID?targetPopup.style.zIndex=110:targetPopup.style.zIndex=100)},aleksUtil.popup.startPopupDrag=function(e,popupID){if(!aleksUtil.popup.popupDragListener){if(aleksUtil.popup.doNotDragAtNextMouseDown)return void(aleksUtil.popup.doNotDragAtNextMouseDown=!1);if(aleksUtil.popup.popupList[popupID].popupIsMinimized)return void aleksUtil.popup.restorePopup(popupID);aleksUtil.popup.activePopup=popupID,aleksUtil.popup.raisePopup(popupID);var eventCoords=e.touches?e.touches[0]:e;aleksUtil.popup.lastMousePos=findMousePos(eventCoords),aleksUtil.popup.popupPos=findPos(aleksUtil.popup.popupList[popupID].popupFrame),global.isTablet?(aleksUtil.popup.popupDragListener=emgr2.addEventListener(document,"touchmove",aleksUtil.popup.dragPopup),aleksUtil.popup.popupStopDragListener=emgr2.addEventListener(document,"touchend",aleksUtil.popup.stopPopupDrag)):(aleksUtil.popup.popupDragListener=emgr2.addEventListener(document,"mousemove",aleksUtil.popup.dragPopup),aleksUtil.popup.popupStopDragListener=emgr2.addEventListener(document,"mouseup",aleksUtil.popup.stopPopupDrag)),aleksUtil.event.preventDefault(e)}},aleksUtil.popup.eventOnMouseOutDocument=function(e){!e&&(e=window.event);var from=e.relatedTarget||e.toElement||e.srcElement;(!from||"HTML"==from.nodeName||"BODY"==from.nodeName)&&aleksUtil.popup.stopPopupDrag(e)},aleksUtil.popup.stopPopupDrag=function(e){aleksUtil.popup.popupDragListener&&emgr2.removeEventListener(aleksUtil.popup.popupDragListener),aleksUtil.popup.popupStopDragListener&&emgr2.removeEventListener(aleksUtil.popup.popupStopDragListener),aleksUtil.popup.popupDragListener=null,aleksUtil.popup.popupStopDragListener=null,aleksUtil.event.preventDefault(e)},aleksUtil.popup.dragPopup=function(e){var eventCoords=e.touches?e.touches[0]:e,currentMousePos=findMousePos(eventCoords),lastMousePos=aleksUtil.popup.lastMousePos,mouseMovement=[currentMousePos[0]-lastMousePos[0],currentMousePos[1]-lastMousePos[1]],targetPopup=aleksUtil.popup.popupList[aleksUtil.popup.activePopup].popupFrame;aleksUtil.popup.popupPos=[aleksUtil.popup.popupPos[0]+mouseMovement[0],aleksUtil.popup.popupPos[1]+mouseMovement[1]],aleksUtil.popup.popupList[aleksUtil.popup.activePopup].keepPopupOnScreen&&(aleksUtil.popup.popupPos[0]=Math.max(0,aleksUtil.popup.popupPos[0]),aleksUtil.popup.popupPos[1]=Math.max(0,aleksUtil.popup.popupPos[1])),targetPopup.style.left=aleksUtil.popup.popupPos[0]+"px",targetPopup.style.top=aleksUtil.popup.popupPos[1]+"px",aleksUtil.popup.lastMousePos=currentMousePos.slice(0),aleksUtil.event.preventDefault(e)},aleksUtil.popup.minimizePopup=function(targetPopup){if("number"!=typeof targetPopup)var targetPopupId=+targetPopup.id.replace(/aleksPopup/,"");else var targetPopupId=targetPopup,targetPopup=di("aleksPopup"+targetPopupId);var targetPopupTitlebar=di("aleksPopup"+targetPopupId+"_titlebar"),titlebarWidth=targetPopupTitlebar.offsetWidth;targetPopup.style.display="none",aleksUtil.popup.popupList[targetPopupId].popupIsMinimized=!0,document.body.appendChild(targetPopupTitlebar),aleksUtil.DOM.setCSSFixed(targetPopupTitlebar,"right",40,"bottom",0),targetPopupTitlebar.style.border="2px solid black",targetPopupTitlebar.style.borderStyle="solid solid none",targetPopupTitlebar.style.backgroundColor="lightgrey",targetPopupTitlebar.style.width=titlebarWidth+"px"},aleksUtil.popup.restorePopup=function(targetPopup){if("number"!=typeof targetPopup)var targetPopupId=+targetPopup.id.replace(/aleksPopup|_titlebar/g,"");else var targetPopupId=targetPopup;var targetPopup=di("aleksPopup"+targetPopupId),targetPopupTitlebar=di("aleksPopup"+targetPopupId+"_titlebar");aleksUtil.popup.popupList[targetPopupId].popupIsMinimized=!1,targetPopup.appendChild(targetPopupTitlebar),targetPopupTitlebar.style.position="absolute",targetPopupTitlebar.style.top="0px",targetPopupTitlebar.style.left="0px",targetPopupTitlebar.style.bottom="auto",targetPopupTitlebar.style.right="auto",targetPopupTitlebar.style.border="1px solid black",targetPopupTitlebar.style.borderStyle="none none solid",targetPopupTitlebar.style.backgroundColor="lightgrey",targetPopupTitlebar.style.width="100%",targetPopup.style.display="block"},aleksUtil.popup.isPopupMinimized=function(popupId){return aleksUtil.popup.popupList[popupId].popupIsMinimized},aleksUtil.popup.getPopupID=function(popup){for(var i=0;i<aleksUtil.popup.popupList.length;i++)if(aleksUtil.popup.popupList[i].popupFrame==popup)return aleksUtil.popup.popupList[i].popupID},aleksUtil.filterCE=function(){function filterChromeExtension(blackListedChromeExtension){isChrome&&blackListedChromeExtension.forEach(function(ce){__detect(ce)})}var __detect=function(checkUrl){var s=document.createElement("script");s.onload=function(){__isInstalled(checkUrl)},s.src=checkUrl.url,dom.Timer.schedule(new dom.Task(function(){document.body.appendChild(s)},this),20)},__isInstalled=function(checkUrl){aleks.errorAPI.reportError("CE:"+checkUrl.code)};return filterChromeExtension}();function EventDispatcher(){this._listeners={},this.__listenerID=0}EventDispatcher.prototype.addEventListener=function(type,listener,targetObject){return"undefined"==typeof this._listeners[type]&&(this._listeners[type]=[]),this.__listenerID++,this._listeners[type].push({listener:listener,targetObject:targetObject,id:this.__listenerID}),this.__listenerID},EventDispatcher.prototype.removeEventListener=function(listenerID){for(var type in this._listeners)for(var i=0;i<this._listeners[type].length;i++)if(this._listeners[type][i].id==listenerID){this._listeners[type].splice(i,1);break}},EventDispatcher.prototype.dispatchEvent=function(type,event){if("undefined"!=typeof this._listeners[type])for(var i=this._listeners[type].length-1;0<=i;i--){var listenerObj=this._listeners[type][i],targetObject="undefined"==typeof listenerObj.targetObject?this:listenerObj.targetObject,methodOwner="undefined"==typeof listenerObj.targetObject?global:listenerObj.targetObject;if("function"==typeof listenerObj.listener)listenerObj.listener.call(targetObject,event);else if(listenerObj.listener){var functionName=listenerObj.listener;"function"==typeof methodOwner[functionName]&&methodOwner[functionName].call(targetObject,event)}}};function CharacterScanner(text){this._text=text,this._offset=0}CharacterScanner.prototype.getOffset=function(){return this._offset},CharacterScanner.prototype.seek=function(offset){this._offset=offset},CharacterScanner.prototype.read=function(nbChars){if("undefined"==typeof nbChars&&(nbChars=1),this._offset<this._text.length){var skippedText=this._text.substr(this._offset,nbChars);return this._offset+=skippedText.length,skippedText}return""},CharacterScanner.prototype.unread=function(nbChars){"undefined"==typeof nbChars&&(nbChars=1),this._offset=Math.max(this._offset-nbChars,0)},CharacterScanner.prototype.readRegExp=function(patternString){var pattern=new RegExp("^"+patternString),matches=this._text.substr(this._offset).match(pattern);return matches?(this._offset+=matches[0].length,matches):null},CharacterScanner.prototype.readString=function(stringToRead){if(!stringToRead)return!1;var nbChars=stringToRead.length,readText="";return!!(this._offset+nbChars<this._text.length)&&(readText=this.read(nbChars),readText==stringToRead||(this.unread(nbChars),!1))},CharacterScanner.prototype.skip=function(nbChars){"undefined"==typeof nbChars&&(nbChars=1),this._offset=Math.min(this._offset+nbChars,this._text.length)},CharacterScanner.prototype.isEndReached=function(){return this._offset>=this._text.length};function RGBColor(red,green,blue){this.red=red,this.green=green,this.blue=blue}RGBColor.prototype.getChroma=function(){var M=Math.max(this.red,this.green,this.blue),m=Math.min(this.red,this.green,this.blue),chroma=M-m;return chroma},RGBColor.prototype.getHue=function(){var chroma=this.getChroma(),hueNormalized=0;0!=chroma&&(this.red>=this.green&&this.red>=this.blue?hueNormalized=(this.green-this.blue)/chroma:this.green>=this.red&&this.green>=this.blue?hueNormalized=(this.blue-this.red)/chroma+2:this.blue>=this.red&&this.blue>=this.green&&(hueNormalized=(this.red-this.green)/chroma+4));var hue=(60*hueNormalized%360+360)%360;return hue},RGBColor.prototype.getLightness=function(){var M=Math.max(this.red,this.green,this.blue),m=Math.min(this.red,this.green,this.blue),lightness=.5*(M+m);return lightness},RGBColor.prototype.getLuma=function(){var luma=.299*this.red+.587*this.green+.114*this.blue;return luma},RGBColor.prototype.getSaturationHSL=function(){var chroma=this.getChroma(),saturation=0;return 0!=chroma&&(saturation=chroma/(1-Math.abs(2*this.getLightness()-1))),saturation},RGBColor.prototype.toHSLColor=function(){var hue=this.getHue(),saturation=this.getSaturationHSL(),lightness=this.getLightness();return new HSLColor(hue,saturation,lightness)},RGBColor.prototype.toYCHColor=function(){var hue=this.getHue(),chroma=this.getChroma(),luma=this.getLuma();return new YCHColor(luma,chroma,hue)},RGBColor.prototype.getDarkerColor=function(darknessRatio){return this.getDarkerLumaColor(darknessRatio)},RGBColor.prototype.getDarkerLumaColor=function(darknessRatio){return this.getCopyWithOtherLuma(this.getLuma()*(1-darknessRatio))},RGBColor.prototype.getDarkerLightnessColor=function(darknessRatio){return this.getCopyWithOtherLightness(this.getLightness()*(1-darknessRatio))},RGBColor.prototype.getLighterColor=function(lightnessRatio){return this.getLighterLumaColor(lightnessRatio)},RGBColor.prototype.getLighterLumaColor=function(lightnessRatio){return this.getCopyWithOtherLuma(1-(1-this.getLuma())*(1-lightnessRatio))},RGBColor.prototype.getLighterLightnessColor=function(lightnessRatio){return this.getCopyWithOtherLightness(1-(1-this.getLightness())*(1-lightnessRatio))},RGBColor.prototype.getCopyWithOtherLightness=function(newLightness){var hue=this.getHue(),saturation=this.getSaturationHSL(),lightness=newLightness;return new HSLColor(hue,saturation,lightness).toRGBColor()},RGBColor.prototype.getCopyWithOtherLuma=function(newLuma){var hue=this.getHue(),chroma=this.getChroma(),luma=newLuma;return new YCHColor(luma,chroma,hue).toRGBColorLumaSafe()},RGBColor.prototype.toHexaString=function(){var redValue=Math.max(Math.min(Math.round(255*this.red),255),0),greenValue=Math.max(Math.min(Math.round(255*this.green),255),0),blueValue=Math.max(Math.min(Math.round(255*this.blue),255),0),redString=(16>redValue?"0":"")+new Number(redValue).toString(16),greenString=(16>greenValue?"0":"")+new Number(greenValue).toString(16),blueString=(16>blueValue?"0":"")+new Number(blueValue).toString(16);return"#"+redString+greenString+blueString},RGBColor.fromHexaString=function(hexaColor){var redValue=parseInt(hexaColor.substring(1,3),16),greenValue=parseInt(hexaColor.substring(3,5),16),blueValue=parseInt(hexaColor.substring(5,7),16),red=redValue/255,green=greenValue/255,blue=blueValue/255;return new RGBColor(red,green,blue)},RGBColor.getRGBColorBetween=function(rgbColor1,rgbColor2,ratio){return"undefined"==typeof ratio&&(ratio=.5),new RGBColor(rgbColor1.red+(rgbColor2.red-rgbColor1.red)*ratio,rgbColor1.green+(rgbColor2.green-rgbColor1.green)*ratio,rgbColor1.blue+(rgbColor2.blue-rgbColor1.blue)*ratio)};function HSLColor(hue,saturation,lightness){this.hue=hue,this.saturation=saturation,this.lightness=lightness}HSLColor.prototype.toRGBColor=function(){var chroma=(1-Math.abs(2*this.lightness-1))*this.saturation,hueNormalized=this.hue/60,x=chroma*(1-Math.abs(hueNormalized%2-1)),red1=0,green1=0,blue1=0;1>hueNormalized?(red1=chroma,green1=x):2>hueNormalized?(red1=x,green1=chroma):3>hueNormalized?(green1=chroma,blue1=x):4>hueNormalized?(green1=x,blue1=chroma):5>hueNormalized?(red1=x,blue1=chroma):6>hueNormalized&&(red1=chroma,blue1=x);var m=this.lightness-.5*chroma;return new RGBColor(Math.min(red1+m,1),Math.min(green1+m,1),Math.min(blue1+m,1))};function YCHColor(luma,chroma,hue){for(this.hue=hue;360<=this.hue;)this.hue-=360;for(;0>this.hue;)this.hue+=360;this.chroma=chroma,this.luma=luma}YCHColor.prototype.toRGBColorLumaSafe=function(){var hueNormalized=this.hue/60,x=this.chroma*(1-Math.abs(hueNormalized%2-1)),red1=0,green1=0,blue1=0;1>hueNormalized?(red1=this.chroma,green1=x):2>hueNormalized?(red1=x,green1=this.chroma):3>hueNormalized?(green1=this.chroma,blue1=x):4>hueNormalized?(green1=x,blue1=this.chroma):5>hueNormalized?(red1=x,blue1=this.chroma):6>hueNormalized&&(red1=this.chroma,blue1=x);var luma1=.299*red1+.587*green1+.114*blue1,m=this.luma-luma1;if(0>m){var ratio=this.luma/luma1;return new RGBColor(Math.max(0,Math.min(red1*ratio,1)),Math.max(0,Math.min(green1*ratio,1)),Math.max(0,Math.min(blue1*ratio,1)))}if(m>1-this.chroma){var ratio=(this.luma-1)/(luma1-this.chroma);return new RGBColor(Math.max(0,Math.min(1-(this.chroma-red1)*ratio,1)),Math.max(0,Math.min(1-(this.chroma-green1)*ratio,1)),Math.max(0,Math.min(1-(this.chroma-blue1)*ratio,1)))}return new RGBColor(Math.max(0,Math.min(red1+m,1)),Math.max(0,Math.min(green1+m,1)),Math.max(0,Math.min(blue1+m,1)))},YCHColor.prototype.toRGBColor=function(){var hueNormalized=this.hue/60,x=this.chroma*(1-Math.abs(hueNormalized%2-1)),red1=0,green1=0,blue1=0;1>hueNormalized?(red1=this.chroma,green1=x):2>hueNormalized?(red1=x,green1=this.chroma):3>hueNormalized?(green1=this.chroma,blue1=x):4>hueNormalized?(green1=x,blue1=this.chroma):5>hueNormalized?(red1=x,blue1=this.chroma):6>hueNormalized&&(red1=this.chroma,blue1=x);var m=this.luma-(.299*red1+.587*green1+.114*blue1),red=red1+m,green=green1+m,blue=blue1+m;return new RGBColor(Math.max(0,Math.min(red,1)),Math.max(0,Math.min(green,1)),Math.max(0,Math.min(blue,1)))},YCHColor.getYCHColorBetween=function(ychColor1,ychColor2,ratio){return"undefined"==typeof ratio&&(ratio=.5),new YCHColor(ychColor1.luma+(ychColor2.luma-ychColor1.luma)*ratio,ychColor1.chroma+(ychColor2.chroma-ychColor1.chroma)*ratio,ychColor1.hue+(ychColor2.hue-ychColor1.hue)*ratio)};var StringAccents={t_regexp:null,t_array:null,init:function(){if(null===StringAccents.t_regexp){var conversions={};conversions.ae=["\xE4","\xE6","\u01FD"],conversions.oe=["\xF6","\u0153"],conversions.ue=["\xFC"],conversions.Ae=["\xC4"],conversions.Ue=["\xDC"],conversions.Oe=["\xD6"],conversions.A=["\xC0","\xC1","\xC2","\xC3","\xC4","\xC5","\u01FA","\u0100","\u0102","\u0104","\u01CD"],conversions.a=["\xE0","\xE1","\xE2","\xE3","\xE5","\u01FB","\u0101","\u0103","\u0105","\u01CE","\xAA"],conversions.C=["\xC7","\u0106","\u0108","\u010A","\u010C"],conversions.c=["\xE7","\u0107","\u0109","\u010B","\u010D"],conversions.D=["\xD0","\u010E","\u0110"],conversions.d=["\xF0","\u010F","\u0111"],conversions.E=["\xC8","\xC9","\xCA","\xCB","\u0112","\u0114","\u0116","\u0118","\u011A"],conversions.e=["\xE8","\xE9","\xEA","\xEB","\u0113","\u0115","\u0117","\u0119","\u011B"],conversions.G=["\u011C","\u011E","\u0120","\u0122"],conversions.g=["\u011D","\u011F","\u0121","\u0123"],conversions.H=["\u0124","\u0126"],conversions.h=["\u0125","\u0127"],conversions.I=["\xCC","\xCD","\xCE","\xCF","\u0128","\u012A","\u012C","\u01CF","\u012E","\u0130"],conversions.i=["\xEC","\xED","\xEE","\xEF","\u0129","\u012B","\u012D","\u01D0","\u012F","\u0131"],conversions.J=["\u0134"],conversions.j=["\u0135"],conversions.K=["\u0136"],conversions.k=["\u0137"],conversions.L=["\u0139","\u013B","\u013D","\u013F","\u0141"],conversions.l=["\u013A","\u013C","\u013E","\u0140","\u0142"],conversions.N=["\xD1","\u0143","\u0145","\u0147"],conversions.n=["\xF1","\u0144","\u0146","\u0148","\u0149"],conversions.O=["\xD2","\xD3","\xD4","\xD5","\u014C","\u014E","\u01D1","\u0150","\u01A0","\xD8","\u01FE"],conversions.o=["\xF2","\xF3","\xF4","\xF5","\u014D","\u014F","\u01D2","\u0151","\u01A1","\xF8","\u01FF","\xBA"],conversions.R=["\u0154","\u0156","\u0158"],conversions.r=["\u0155","\u0157","\u0159"],conversions.S=["\u015A","\u015C","\u015E","\u0160"],conversions.s=["\u015B","\u015D","\u015F","\u0161","\u017F"],conversions.T=["\u0162","\u0164","\u0166"],conversions.t=["\u0163","\u0165","\u0167"],conversions.U=["\xD9","\xDA","\xDB","\u0168","\u016A","\u016C","\u016E","\u0170","\u0172","\u01AF","\u01D3","\u01D5","\u01D7","\u01D9","\u01DB"],conversions.u=["\xF9","\xFA","\xFB","\u0169","\u016B","\u016D","\u016F","\u0171","\u0173","\u01B0","\u01D4","\u01D6","\u01D8","\u01DA","\u01DC"],conversions.Y=["\xDD","\u0178","\u0176"],conversions.y=["\xFD","\xFF","\u0177"],conversions.W=["\u0174"],conversions.w=["\u0175"],conversions.Z=["\u0179","\u017B","\u017D"],conversions.z=["\u017A","\u017C","\u017E"],conversions.AE=["\xC6","\u01FC"],conversions.ss=["\xDF"],conversions.IJ=["\u0132"],conversions.ij=["\u0133"],conversions.OE=["\u0152"],conversions.f=["\u0192"];var tmp_translate_char_li=["["];for(var i in StringAccents.t_array={},conversions)for(var ss=conversions[i],j=0;j<ss.length;j++)tmp_translate_char_li.push(ss[j]),StringAccents.t_array[ss[j]]=i;tmp_translate_char_li.push("]");var tmp_translate_char=tmp_translate_char_li.join("");StringAccents.t_regexp=new RegExp(tmp_translate_char,"g")}},removeAccents:function(s){return StringAccents.init(),s.replace(StringAccents.t_regexp,function(match){return StringAccents.t_array[match]})}};aleksUtil.randomizeList=function(dataList,numSplice){var shuffle=function(myArray){var i=myArray.length;if(0===i)return[];for(;--i;){var j=Math.floor(Math.random()*(i+1)),tempi=myArray[i],tempj=myArray[j];myArray[i]=tempj,myArray[j]=tempi}return myArray};numSplice=numSplice||dataList.length;for(var randList=dataList;randList.length<numSplice;)randList=randList.concat(dataList);return randList=shuffle(randList),randList.splice(numSplice),randList},aleksUtil.getDefaultName=function(baseName,names){let removeSuffix=!!(2<arguments.length&&arguments[2]!==void 0)&&arguments[2],suffix=0;const possibleSuffix=[suffix],defaultNameRegExp=new RegExp(`^${baseName} (?<suffix>[0-9]+)$`),checkForSuffix=new RegExp(/ - /);names.forEach(name=>{const isRecurring=checkForSuffix.exec(name);let newName=name;isRecurring&&!0===removeSuffix&&(newName=name.substring(0,isRecurring.index));const nameMatch=defaultNameRegExp.exec(newName);nameMatch&&possibleSuffix.push(0|nameMatch.groups.suffix)}),possibleSuffix.sort();const possibleSuffixSet=new Set(possibleSuffix);for(let value of possibleSuffixSet)if(!possibleSuffixSet.has(value+1)){suffix=value;break}return`${baseName} ${suffix+1}`},aleksUtil.getFileExtension=function(fileName){const fileExtension=fileName.match(/\.([^\.]*)$/);return fileExtension?fileExtension[1].toLowerCase():null};