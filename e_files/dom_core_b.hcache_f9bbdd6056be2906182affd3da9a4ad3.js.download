/**
 * Copyright © 2024 UC Regents and ALEKS Corporation
 * ALEKS® is a registered trademark of ALEKS Corporation.
**/
this.dom=this.dom||{},dom.KeyCode={BACKSPACE:8,TAB:9,RETURN:13,SHIFT:16,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},function(){var _getLocalScope=function(object){if(object&&("object"==typeof object||"function"==typeof object)&&"function"==typeof object.hasOwnProperty&&!("prototype"in object.hasOwnProperty)){var localFunctionConstructor=object.hasOwnProperty.constructor;return!localFunctionConstructor.__dom_globalScope&&(localFunctionConstructor.__dom_globalScope=localFunctionConstructor("return this;")()),localFunctionConstructor.__dom_globalScope}return null};(function(){var _protectedKey={};dom.Event=function(){throw new TypeError("Illegal constructor")},dom.Event.isEvent=function(domEvent){if(domEvent&&"object"==typeof domEvent){var local=_getLocalScope(domEvent);return local&&local.Event?domEvent instanceof local.Event||!!local.MSEventObj&&domEvent instanceof local.MSEventObj:(!("constructor"in domEvent)||!!(domEvent.constructor&&domEvent.constructor.prototype&&null===domEvent.constructor.prototype.constructor))&&"string"==typeof domEvent.type&&"object"==typeof domEvent.srcElement&&"boolean"==typeof domEvent.cancelBubble&&"number"==typeof domEvent.clientX&&"boolean"==typeof domEvent.ctrlKey}return!1};var _isOldIEEvent=function(domEvent){if(domEvent&&"object"==typeof domEvent){if(!global.MSEventObj&&global.Event&&global.Event.prototype&&null!==global.Event.prototype.constructor)return!1;var local=_getLocalScope(domEvent);return local&&local.MSEventObj?domEvent instanceof local.MSEventObj||!!local.MSEventObj&&domEvent instanceof local.MSEventObj:(!("constructor"in domEvent)||!!(domEvent.constructor&&domEvent.constructor.prototype&&null===domEvent.constructor.prototype.constructor))&&"string"==typeof domEvent.type&&"object"==typeof domEvent.srcElement&&"boolean"==typeof domEvent.cancelBubble&&"number"==typeof domEvent.clientX&&"boolean"==typeof domEvent.ctrlKey}return!1},_oldIENonBubblingEvent={abort:!0,afterprint:!0,beforeprint:!0,beforeunload:!0,blur:!0,bounce:!0,error:!0,filterchange:!0,finish:!0,focus:!0,load:!0,losecapture:!0,propertychange:!0,readystatechange:!0,rowexit:!0,start:!0,stop:!0,unload:!0},_fixOldIEEvent=function(oldIEEvent,currentTarget){if("object"!=typeof oldIEEvent.returnValue){var savedReturnValue=oldIEEvent.returnValue,newEventObject=document.createEventObject(oldIEEvent);newEventObject.__canceledFlag=!1,newEventObject.__stopPropagationFlag=!1,newEventObject.__stopImmediatePropagationFlag=!1,newEventObject.returnValue=savedReturnValue,newEventObject.preventDefault=function(){this.__canceledFlag=!0,this.returnValue=!1},newEventObject.stopPropagation=function(){this.__stopPropagationFlag=!0,this.cancelBubble=!0},newEventObject.stopImmediatePropagation=function(){this.__stopImmediatePropagationFlag=!0,this.__stopPropagationFlag=!0},newEventObject.target=oldIEEvent.srcElement,newEventObject.bubbles=!_oldIENonBubblingEvent[oldIEEvent.type],newEventObject.cancelable=!0;var newReturnValue={__event:newEventObject,toString:function(){return!this.__event.__canceledFlag+""},valueOf:function(){return!this.__event.__canceledFlag}};oldIEEvent.returnValue=newReturnValue,dom.Timer.schedule(new dom.Task(function(){newEventObject.eventPhase=0,newEventObject.currentTarget=null}))}var fixedEvent=oldIEEvent.returnValue.__event;return fixedEvent.currentTarget=currentTarget,fixedEvent.eventPhase=currentTarget===fixedEvent.target?2:3,fixedEvent};dom.Event.standardizeKeyboardEventCode=function(event){switch(event&&event.keyCode){case 27:event.code="Escape";break;case 90:case 122:event.code="KeyZ";break;case 89:case 121:event.code="KeyY";break;case 77:case 109:event.code="KeyM";break;case 69:case 101:event.code="KeyE";break;case 37:event.code="ArrowLeft";break;case 38:event.code="ArrowUp";break;case 39:event.code="ArrowRight";break;case 40:event.code="ArrowDown";break;case 32:event.code="Space";break;case 13:event.code="Enter"}return event},dom.EventListenerReference=function(domElement,eventName,listener,options){if(arguments[arguments.length-1]===_protectedKey)this._domElement=domElement,this._eventName=eventName,this._listener=listener,this._options=options;else throw new TypeError("Illegal constructor")},dom.LegacyEventListenerReference=function(domElement,eventName,listener){if(arguments[arguments.length-1]===_protectedKey)this._super(domElement,eventName,listener,!1,_protectedKey);else throw new TypeError("Illegal constructor")},aleks.extend(dom.LegacyEventListenerReference,dom.EventListenerReference),dom.EventTarget=function(){throw new TypeError("Illegal constructor")},dom.EventTarget.isEventTarget=function(domEventTarget){if(domEventTarget&&("object"==typeof domEventTarget||"function"==typeof domEventTarget)){var local=_getLocalScope(domEventTarget);return local&&local.EventTarget?domEventTarget instanceof local.EventTarget:"addEventListener"in domEventTarget&&"function"==typeof domEventTarget.addEventListener&&(!("prototype"in domEventTarget.addEventListener)||"function"==typeof global.addEventListener&&"prototype"in global.addEventListener&&Function.prototype.toString.call(global.addEventListener)===Function.prototype.toString.call(domEventTarget.addEventListener))||"attachEvent"in domEventTarget&&"object"==typeof domEventTarget.attachEvent&&!("constructor"in domEventTarget.attachEvent)||"hasChildNodes"in domEventTarget&&"object"==typeof domEventTarget.hasChildNodes&&!("constructor"in domEventTarget.hasChildNodes)||"unknown"==typeof domEventTarget.onreadystatechange||"unknown"==typeof domEventTarget.responseBody}return!1};var _buildListenerWrapper=function(domElement,listener,targetObject){var listenerWrapper;if("function"==typeof listener){var thisObject=targetObject||domElement;listenerWrapper=function(event){listener.call(thisObject,event)}}else if(listener&&listener.handleEvent)listenerWrapper=function(event){listener.handleEvent(event)};else if(targetObject&&targetObject[listener])listenerWrapper=function(event){targetObject[listener](event)};else throw new Error(listener+" is supposed to be a method of the object "+targetObject);return function(event){if(event=event||window.event,_isOldIEEvent(event)){var fixedOldIEEvent=_fixOldIEEvent(event,domElement);fixedOldIEEvent&&!fixedOldIEEvent.__stopImmediatePropagationFlag&&(listenerWrapper(fixedOldIEEvent),fixedOldIEEvent.__stopPropagationFlag&&(event.cancelBubble=!0))}else listenerWrapper(event)}};dom.EventTarget.addEventListener=function(domElement,eventName,listener,targetObject,options){if(domElement.addEventListener){var listenerWrapper=_buildListenerWrapper(domElement,listener,targetObject);return domElement.addEventListener(eventName,listenerWrapper,options),new dom.EventListenerReference(domElement,eventName,listenerWrapper,options,_protectedKey)}if(domElement.attachEvent){var listenerWrapper=_buildListenerWrapper(domElement,listener,targetObject);return domElement.attachEvent("on"+eventName,listenerWrapper),new dom.EventListenerReference(domElement,eventName,listenerWrapper,options,_protectedKey)}return dom.EventTarget.addLegacyEventListener(domElement,eventName,listener,targetObject)},dom.EventTarget.addLegacyEventListener=function(domElement,eventName,listener,targetObject){var previousUniqueListener=domElement["on"+eventName],newUniqueListener=previousUniqueListener;(!previousUniqueListener||!previousUniqueListener.__eem_addListener)&&(newUniqueListener=function(){var listListeners=[],uniqueListener=function(){for(var i=0;i<listListeners.length;i++)listListeners[i].apply(this,arguments)};return uniqueListener.__eem_addListener=function(listenerWrapper){listListeners.push(listenerWrapper)},uniqueListener.__eem_removeListener=function(listenerWrapper){for(var i=0;i<listListeners.length;i++)if(listListeners[i]===listenerWrapper)return void listListeners.splice(i,1)},uniqueListener}(),"function"==typeof previousUniqueListener&&newUniqueListener.__eem_addListener(previousUniqueListener),domElement["on"+eventName]=newUniqueListener);var listenerWrapper=_buildListenerWrapper(domElement,listener,targetObject);return newUniqueListener.__eem_addListener(listenerWrapper),new dom.LegacyEventListenerReference(domElement,eventName,listenerWrapper,_protectedKey)},dom.EventTarget.removeEventListener=function(eventListenerRef){if(eventListenerRef instanceof dom.EventListenerReference)if(eventListenerRef instanceof dom.LegacyEventListenerReference){var domElement=eventListenerRef._domElement,uniqueListener=domElement["on"+eventListenerRef._eventName];uniqueListener&&uniqueListener.__eem_removeListener&&uniqueListener.__eem_removeListener(eventListenerRef._listener)}else{var domElement=eventListenerRef._domElement;"object"==typeof domElement&&("function"==typeof domElement.removeEventListener&&domElement.removeEventListener?domElement.removeEventListener(eventListenerRef._eventName,eventListenerRef._listener,eventListenerRef._options):("function"==typeof domElement.removeEventListener||"object"==typeof domElement.removeEventListener)&&domElement.detachEvent&&domElement.detachEvent("on"+eventListenerRef._eventName,eventListenerRef._listener))}},dom.EventTarget.dispatchEvent=function(domElement,eventName,eventSource){var domElementDocument=domElement.ownerDocument||document,initEvent={bubbles:!0,cancelable:!0,view:domElementDocument.defaultView||domElementDocument.parentWindow,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null};for(var key in eventSource)initEvent[key]=eventSource[key];if(domElement.dispatchEvent){if("click"==eventName||"dblclick"==eventName||0===eventName.lastIndexOf("mouse",0)){var event=domElementDocument.createEvent("MouseEvents");event.initMouseEvent(eventName,initEvent.bubbles,initEvent.cancelable,initEvent.view,initEvent.detail,initEvent.screenX,initEvent.screenY,initEvent.clientX,initEvent.clientY,initEvent.ctrlKey,initEvent.altKey,initEvent.shiftKey,initEvent.metaKey,initEvent.button,initEvent.relatedTarget),domElement.dispatchEvent(event)}else if("load"==eventName||"unload"==eventName||"abort"==eventName||"error"==eventName||"select"==eventName||"change"==eventName||"submit"==eventName||"reset"==eventName||"focus"==eventName||"blur"==eventName||"resize"==eventName||"scroll"==eventName){var event=domElementDocument.createEvent("HTMLEvents");event.initEvent(eventName,initEvent.bubbles,initEvent.cancelable),domElement.dispatchEvent(event)}else{var event=domElementDocument.createEvent("Event");event.initEvent(eventName,initEvent.bubbles,initEvent.cancelable),domElement.dispatchEvent(event)}}else if(domElement.fireEvent){var event=domElementDocument.createEventObject();for(var key in initEvent)try{event[key]=initEvent[key]}catch(e){}event.type=eventName,domElement.fireEvent("on"+eventName,event)}}})(),function(){dom.EventManager=function(){this._listEvents=[]},dom.EventManager.prototype.addEventListener=function(domElement,eventName,listener,targetObject,options){var eventListenerRef=dom.EventTarget.addEventListener(domElement,eventName,listener,targetObject,options);return eventListenerRef&&this._listEvents.push(eventListenerRef),eventListenerRef},dom.EventManager.prototype.addLegacyEventListener=function(domElement,eventName,listener,targetObject){var eventListenerRef=dom.EventTarget.addLegacyEventListener(domElement,eventName,listener,targetObject);return eventListenerRef&&this._listEvents.push(eventListenerRef),eventListenerRef},dom.EventManager.prototype.removeEventListener=function(eventListenerRef){for(var i=0;i<this._listEvents.length;i++)if(this._listEvents[i]===eventListenerRef)return dom.EventTarget.removeEventListener(eventListenerRef),void this._listEvents.splice(i,1)},dom.EventManager.prototype.removeAllEventListeners=function(){for(var i=0;i<this._listEvents.length;i++)dom.EventTarget.removeEventListener(this._listEvents[i]),this._listEvents[i]._domElement&&this._listEvents[i]._domElement.getEventManager&&this._listEvents[i]._domElement.getEventManager()instanceof dom.EventManager&&this._listEvents[i]._domElement.getEventManager().removeAllEventListeners();this._listEvents=[]}}(),function(){var _isDOMNode=function(domNode){return domNode&&domNode.nodeType&&"number"==typeof domNode.nodeType},_forceBlurBeforeRemove=function(domNode){if(domNode)try{var ownerDocument=domNode.ownerDocument||document;if(ownerDocument){var activeElement=ownerDocument.activeElement;_isDOMNode(activeElement)&&dom.Node.contains(domNode,activeElement)&&(activeElement.blur&&activeElement.blur(),activeElement===ownerDocument.activeElement&&ownerDocument.body&&ownerDocument.body.focus())}}catch(e){}};dom.Node=function(){throw new TypeError("Illegal constructor")},dom.Node.isNode=function(domNode){if(domNode&&("object"==typeof domNode||"function"==typeof domNode)){var local=_getLocalScope(domNode);return local&&local.Node?domNode instanceof local.Node:"hasChildNodes"in domNode&&("function"==typeof domNode.hasChildNodes&&!("prototype"in domNode.hasChildNodes)||"object"==typeof domNode.hasChildNodes&&!("constructor"in domNode.hasChildNodes))}return!1},dom.Node.contains=function(domContainerNode,domNode){if(domContainerNode===domNode)return!0;if(domContainerNode.contains)return domContainerNode.contains(domNode);if(domContainerNode.compareDocumentPosition)return!!(16&domContainerNode.compareDocumentPosition(domNode));for(var currentElement=domNode;currentElement;currentElement=currentElement.parentNode)if(currentElement===domContainerNode)return!0;return!1},dom.Node.appendChild=function(domNode,child){_forceBlurBeforeRemove(child),domNode.appendChild(child)},dom.Node.insertBefore=function(domNode,newChild,referenceChild){_forceBlurBeforeRemove(newChild),domNode.insertBefore(newChild,referenceChild)},dom.Node.removeChild=function(domNode,child){_forceBlurBeforeRemove(child),domNode.removeChild(child)},dom.Node.removeAllChildren=function(domNode){for(var currentChild=domNode.firstChild;currentChild;currentChild=domNode.firstChild)_forceBlurBeforeRemove(currentChild),domNode.removeChild(currentChild)},dom.Node.replaceChild=function(domNode,newChild,oldChild){_forceBlurBeforeRemove(newChild),_forceBlurBeforeRemove(oldChild),domNode.replaceChild(newChild,oldChild)}}(),function(){var _protectedKey={},_isDOMElement=function(domElement){return domElement&&1===domElement.nodeType},_escapeRegExp=function(string){return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")};dom.ClientRect=function(left,top,right,bottom){if(arguments[arguments.length-1]===_protectedKey)this.__cr_left=left,this.__cr_top=top,this.__cr_right=right,this.__cr_bottom=bottom;else throw new TypeError("Illegal constructor")},dom.ClientRect.prototype.getLeft=function(){return this.__cr_left},dom.ClientRect.prototype.getTop=function(){return this.__cr_top},dom.ClientRect.prototype.getRight=function(){return this.__cr_right},dom.ClientRect.prototype.getBottom=function(){return this.__cr_bottom},dom.ClientRect.prototype.getWidth=function(){return this.__cr_right-this.__cr_left},dom.ClientRect.prototype.getHeight=function(){return this.__cr_bottom-this.__cr_top},dom.Element=function(){throw new TypeError("Illegal constructor")},dom.Element.isElement=function(domElement){if(domElement&&("object"==typeof domElement||"function"==typeof domElement)){var local=_getLocalScope(domElement);return local&&local.Element?domElement instanceof local.Element:"getBoundingClientRect"in domElement&&("function"==typeof domElement.getBoundingClientRect&&!("prototype"in domElement.getBoundingClientRect)||"object"==typeof domElement.getBoundingClientRect&&!("constructor"in domElement.getBoundingClientRect))}return!1},dom.Element.hasAttribute=function(domElement,attribute){if(_isDOMElement(domElement)){if(domElement.hasAttribute)return domElement.hasAttribute(attribute);var attrNode=domElement.getAttributeNode(attribute);return attrNode&&attrNode.specified}},dom.Element.getAttribute=function(domElement,attribute){if(_isDOMElement(domElement))return dom.Element.hasAttribute(domElement,attribute)?domElement.getAttribute(attribute):null},dom.Element.setAttribute=function(domElement,attribute,value){_isDOMElement(domElement)&&domElement.setAttribute(attribute,value)},dom.Element.removeAttribute=function(domElement,attribute){_isDOMElement(domElement)&&domElement.removeAttribute(attribute,0)};var _whiteSpacesRegex=/\s+/g,_trimRegex=/^\s+|\s+$/g,_getListClassNames=function(classNames){var rawListClasses;if("string"==typeof classNames.valueOf()?rawListClasses=[classNames]:0<classNames.length&&(rawListClasses=classNames),rawListClasses){for(var listClasses=[],i=0;i<rawListClasses.length;i++)if("undefined"!=typeof rawListClasses[i]){const strClasses=(rawListClasses[i]+"").trim();0<strClasses.length&&listClasses.push.apply(listClasses,strClasses.split(_whiteSpacesRegex))}return listClasses}return[]};dom.Element.getElementsByClassName=function(){return document.getElementsByClassName?function(classNames,parentElement){var parentElement=_isDOMElement(parentElement)?parentElement:document,listClasses=_getListClassNames(classNames);return Array.prototype.slice.call(parentElement.getElementsByClassName(listClasses.join(" ")),0)}:document.querySelectorAll?function(classNames,parentElement){var parentElement=_isDOMElement(parentElement)?parentElement:document,listClasses=_getListClassNames(classNames);return 0<listClasses.length?document.querySelectorAll("."+listClasses.join(".")):[]}:function(classNames,parentElement){var foundElements,parentElement=_isDOMElement(parentElement)?parentElement:document,elements=parentElement.getElementsByTagName("*");foundElements=[];var listClasses=_getListClassNames(classNames);if(0<listClasses.length){var regexp;if(1==listClasses.length)regexp=new RegExp("(^|\\s)"+_escapeRegExp(listClasses[0])+"(\\s|$)");else{for(var regexpString="",i=0;i<listClasses.length;i++)regexpString+="(?=(^|.*\\s)"+_escapeRegExp(listClasses[i])+"(\\s|$))";regexp=new RegExp(regexpString)}for(var i=0;i<elements.length;i++)regexp.test(elements[i].className)&&foundElements.push(elements[i])}return foundElements}}(),dom.Element.querySelectorAll=function(){return document.querySelectorAll?function(selector,parentElement){var parentElement=_isDOMElement(parentElement)?parentElement:document;return parentElement.querySelectorAll(selector)}:function(selector,parentElement){var foundElements,rootDocument=document,rootElement=document,rootElementIsInDocument=!0,placeHolderElement=null;if(_isDOMElement(parentElement)&&(rootElement=parentElement,rootDocument=parentElement.ownerDocument,!dom.Node.contains(rootDocument,rootElement))){rootElementIsInDocument=!1;var rootParentElement=rootElement.parentNode;rootParentElement&&(placeHolderElement=rootDocument.createComment("query-selector-placeholder"),rootParentElement.replaceChild(placeHolderElement,rootElement)),rootElement.runtimeStyle.display="none",rootDocument.appendChild(rootElement)}var styleSheet=null;rootDocument.__dom_em_querySelectorStyleSheet?styleSheet=rootDocument.__dom_em_querySelectorStyleSheet:(styleSheet=rootDocument.createStyleSheet(),rootDocument.__dom_em_querySelectorStyleSheet=styleSheet);var selectors=selector.replace(/\[for\b/gi,"[htmlFor").split(","),error=!1;try{for(var i=0;i<selectors.length;i++)styleSheet.addRule(selectors[i],"aleks-selector-tag: 1 !important;",0)}catch(e){error=!0}if(!error){var elts=rootElement.getElementsByTagName("*");foundElements=[];for(var i=0;i<elts.length;i++)elts[i].currentStyle["aleks-selector-tag"]&&foundElements.push(elts[i])}for(var nbRulesToRemove=Math.min(selectors.length,styleSheet.rules.length),i=0;i<nbRulesToRemove;i++)styleSheet.removeRule(0);if(!rootElementIsInDocument&&(placeHolderElement?placeHolderElement.parentNode.replaceChild(rootElement,placeHolderElement):rootElement.parentNode.removeChild(rootElement),rootElement.runtimeStyle.display=""),error)throw new Error("SyntaxError: Failed to execute 'querySelectorAll' on '"+rootElement.nodeName+"': '"+selector+"' is not a valid selector.");return foundElements}}(),dom.Element.hasClass=function(domElement,classNames){if(_isDOMElement(domElement)){var listClasses=_getListClassNames(classNames);if(0<listClasses.length){if(domElement.classList&&domElement.classList.contains){for(var i=0;i<listClasses.length;i++)if(!domElement.classList.contains(listClasses[i]))return!1;return!0}for(var cleanedCurrentClassName=(" "+domElement.className+" ").replace(_whiteSpacesRegex," "),i=0;i<listClasses.length;i++)if(0>cleanedCurrentClassName.indexOf(" "+listClasses[i]+" "))return!1;return!0}}},dom.Element.addClass=function(domElement,classNames){if(_isDOMElement(domElement)){var listClasses=_getListClassNames(classNames);if(0<listClasses.length)if(domElement.classList&&domElement.classList.add)for(var i=0;i<listClasses.length;i++)domElement.classList.add(listClasses[i]);else{for(var cleanedCurrentClassName=(" "+domElement.className+" ").replace(_whiteSpacesRegex," "),i=0;i<listClasses.length;i++)0>cleanedCurrentClassName.indexOf(" "+listClasses[i]+" ")&&(cleanedCurrentClassName+=listClasses[i]+" ");var finalClassName=cleanedCurrentClassName.replace(_trimRegex,"");domElement.className!==finalClassName&&(domElement.className=finalClassName)}}},dom.Element.removeClass=function(domElement,classNames){if(_isDOMElement(domElement)){var listClasses=_getListClassNames(classNames);if(0<listClasses.length)if(domElement.classList&&domElement.classList.remove)for(var i=0;i<listClasses.length;i++)domElement.classList.remove(listClasses[i]);else{for(var cleanedCurrentClassName=(" "+domElement.className+" ").replace(_whiteSpacesRegex," "),i=0;i<listClasses.length;i++)for(;0<=cleanedCurrentClassName.indexOf(" "+listClasses[i]+" ");)cleanedCurrentClassName=cleanedCurrentClassName.replace(" "+listClasses[i]+" "," ");var finalClassName=cleanedCurrentClassName.replace(_trimRegex,"");domElement.className!==finalClassName&&(domElement.className=finalClassName)}}},dom.Element.toggleClass=function(domElement,classNames,stateForced){if(3<=arguments.length)stateForced?dom.Element.addClass(domElement,classNames):dom.Element.removeClass(domElement,classNames);else if(_isDOMElement(domElement)){var listClasses=_getListClassNames(classNames);if(0<listClasses.length)if(domElement.classList&&domElement.classList.toggle)for(var i=0;i<listClasses.length;i++)domElement.classList.toggle(listClasses[i]);else{for(var cleanedCurrentClassName=(" "+domElement.className+" ").replace(_whiteSpacesRegex," "),i=0;i<listClasses.length;i++)if(0>cleanedCurrentClassName.indexOf(" "+listClasses[i]+" "))cleanedCurrentClassName+=listClasses[i]+" ";else for(;0<=cleanedCurrentClassName.indexOf(" "+listClasses[i]+" ");)cleanedCurrentClassName=cleanedCurrentClassName.replace(" "+listClasses[i]+" "," ");var finalClassName=cleanedCurrentClassName.replace(_trimRegex,"");domElement.className!==finalClassName&&(domElement.className=finalClassName)}}},dom.Element.getTitle=function(domElement){if(_isDOMElement(domElement))return dom.Element.getAttribute(domElement,"title")},dom.Element.setTitle=function(domElement,title){_isDOMElement(domElement)&&(null===title||"undefined"==typeof title?dom.Element.removeAttribute(domElement,"title"):(title=title+"",""===title?domElement.title=" ":(title.match(/^\s+$/)&&(title="\u200B"+title),domElement.title=title)))};var _isValidTabIndexValue=function(value){return null!==value&&!isNaN(value)};dom.Element.isFocusable=function(domElement){if(domElement){if(_isValidTabIndexValue(dom.Element.getAttribute(domElement,"tabindex")))return!0;var focusableNodes={body:!0,button:!0,frame:!0,iframe:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0},nodeName=domElement.nodeName.toLowerCase();return!!focusableNodes[nodeName]||!!(("a"==nodeName||"area"==nodeName)&&domElement.href)}},dom.Element.isTabbable=function(domElement){if(domElement){var tabbableTabIndex=!1,tabIndexDefined=!1,tabIndexValue=dom.Element.getAttribute(domElement,"tabindex");return _isValidTabIndexValue(tabIndexValue)&&(tabbableTabIndex=0<=parseFloat(tabIndexValue),tabIndexDefined=!0),tabbableTabIndex||!tabIndexDefined&&this.isFocusable()}},dom.Element.setFocusable=function(domElement,value){domElement&&(domElement.__madeFocusable=!!value,value?domElement.__madeTabbable?domElement.tabIndex=0:!dom.Element.isFocusable(domElement)&&(domElement.tabIndex=-1):!value&&dom.Element.isFocusable(domElement)&&("-1"!=domElement.getAttribute("tabindex")&&dom.Element.removeAttribute(domElement,"tabindex"),dom.Element.isFocusable(domElement)&&(domElement.tabIndex=-1)))},dom.Element.setTabbable=function(domElement,value){domElement&&(domElement.__madeTabbable=!!value,value&&!dom.Element.isTabbable(domElement)?domElement.tabIndex=0:!value&&(domElement.__madeFocusable?domElement.tabIndex=-1:dom.Element.isTabbable(domElement)&&(dom.Element.removeAttribute(domElement,"tabindex"),dom.Element.isTabbable(domElement)&&(domElement.tabIndex=-1))))};var __getBoundingClientRect=function(element){try{return element.getBoundingClientRect()}catch(error){return{left:0,top:0,right:0,bottom:0}}};dom.Element.getBoundingClientRect=function(element,opt_referenceElement){if(element&&element.getBoundingClientRect){var eltRect=__getBoundingClientRect(element);if(opt_referenceElement&&opt_referenceElement.getBoundingClientRect){var refRect=__getBoundingClientRect(opt_referenceElement);return new dom.ClientRect(eltRect.left-refRect.left,eltRect.top-refRect.top,eltRect.right-refRect.left,eltRect.bottom-refRect.top,_protectedKey)}return new dom.ClientRect(eltRect.left,eltRect.top,eltRect.right,eltRect.bottom,_protectedKey)}return null};var _setStyleFunctions={},_vendorCamelCasePrefixes=["ms","Webkit","Moz","O","Khtml"],_cssPropertyToCamelCase=function(){var cache={},regexReplaceFunction=function(match,p1){return p1.toUpperCase()};return function(cssProperty){if(null!=cssProperty){if(cssProperty+="","undefined"!=typeof cache[cssProperty])return cache[cssProperty];var camelCaseProperty;return"float"==cssProperty?document&&document.documentElement&&document.documentElement.style&&"undefined"==typeof document.documentElement.style.cssFloat?camelCaseProperty="styleFloat":camelCaseProperty="cssFloat":(camelCaseProperty=cssProperty.replace(/\-([a-z])/g,regexReplaceFunction),0===camelCaseProperty.lastIndexOf("Ms",0)&&(camelCaseProperty="m"+camelCaseProperty.substr(1))),cache[cssProperty]=camelCaseProperty,camelCaseProperty}return null}}(),_camelCaseToCSSProperty=function(){var cache={},regexReplaceFunction=function(match){return"-"+match.toLowerCase()};return function(camelCaseProperty){if(null!=camelCaseProperty){if(camelCaseProperty+="","undefined"!=typeof cache[camelCaseProperty])return cache[camelCaseProperty];var cssProperty;return"styleFloat"==camelCaseProperty||"cssFloat"==camelCaseProperty?cssProperty="float":(cssProperty=camelCaseProperty.replace(/[A-Z]/g,regexReplaceFunction),0===cssProperty.lastIndexOf("ms-",0)&&(cssProperty="-"+cssProperty)),cache[camelCaseProperty]=cssProperty,cssProperty}return null}}(),_getCamelCaseVendorStyleProperty=function(){var cache={};return function(cssProperty){if(null!=cssProperty){if(cssProperty+="","undefined"!=typeof cache[cssProperty])return cache[cssProperty];var camelCaseProperty=_cssPropertyToCamelCase(cssProperty),camelCaseVendorProperty=null;if(camelCaseProperty in document.documentElement.style)camelCaseVendorProperty=camelCaseProperty;else for(var currentCamelCaseVendorProperty,i=0;i<_vendorCamelCasePrefixes.length;i++)currentCamelCaseVendorProperty=_vendorCamelCasePrefixes[i]+(camelCaseProperty.charAt(0).toUpperCase()+camelCaseProperty.substr(1)),currentCamelCaseVendorProperty in document.documentElement.style&&(camelCaseVendorProperty=currentCamelCaseVendorProperty);return cache[cssProperty]=camelCaseVendorProperty,camelCaseVendorProperty}return null}}(),_getVendorStyleProperty=function(cssProperty){return _camelCaseToCSSProperty(_getCamelCaseVendorStyleProperty(cssProperty))},_getSetVendorStyleFunction=function(cssProperty){var camelCaseVendorProperty=_getCamelCaseVendorStyleProperty(cssProperty);return null==camelCaseVendorProperty?function(){}:function(domElement,cssCamelCaseProperty,cssValue){domElement.style[camelCaseVendorProperty]=cssValue}},_setDOMElementCamelCaseStyle=function(domElement,cssCamelCaseProperty,cssValue){try{domElement.style[cssCamelCaseProperty]=cssValue}catch(e){try{console.log("ERROR: "+cssCamelCaseProperty+": "+cssValue)}catch(e2){}}},_hasNativeTransformSupport=function(){var cache;return function(){return null==cache&&(cache=null!=_getCamelCaseVendorStyleProperty("transform")),cache}}(),_hasNativeTransform3DSupport=function(){var cache;return function(){if(null==cache){var camelCaseVendorProperty=_getCamelCaseVendorStyleProperty("transform");if(null!=camelCaseVendorProperty){var dummyElement=document.createElement("div");try{dummyElement.style[camelCaseVendorProperty]="translateZ(0px)"}catch(e){}cache=""!=dummyElement.style[camelCaseVendorProperty]}else cache=!1}return cache}}();dom.Element.getVendorStyleProperty=function(cssProperty){return _getVendorStyleProperty(cssProperty)},dom.Element.getKebabCaseStyleProperty=function(cssProperty){return _camelCaseToCSSProperty(cssProperty)},dom.Element.getCamelCaseVendorStyleProperty=function(cssProperty){return _getCamelCaseVendorStyleProperty(cssProperty)},dom.Element.getCamelCaseStyleProperty=function(cssProperty){return _cssPropertyToCamelCase(cssProperty)},dom.Element.setStyle=function(element,style){if(element&&style&&element.style)for(var cssProperty in style){var camelCaseProperty=_cssPropertyToCamelCase(cssProperty);if(0===camelCaseProperty.lastIndexOf("Std",0))_setDOMElementCamelCaseStyle(element,camelCaseProperty.charAt(3).toLowerCase()+camelCaseProperty.substr(4),style[cssProperty]);else if(0===camelCaseProperty.lastIndexOf("Vendor",0)){var camelCaseVendorProperty=_getCamelCaseVendorStyleProperty(camelCaseProperty.charAt(6).toLowerCase()+camelCaseProperty.substr(7));camelCaseVendorProperty&&_setDOMElementCamelCaseStyle(element,camelCaseVendorProperty,style[cssProperty])}else _setStyleFunctions[camelCaseProperty]?_setStyleFunctions[camelCaseProperty].call(dom.Element,element,camelCaseProperty,style[cssProperty]):_setDOMElementCamelCaseStyle(element,camelCaseProperty,style[cssProperty])}},dom.Element.addStyleSupport=function(cssProperty,styleSetterFunction){_setStyleFunctions[_cssPropertyToCamelCase(cssProperty)]=styleSetterFunction},dom.Element.addVendorStyleSupport=function(cssProperty){_setStyleFunctions[_cssPropertyToCamelCase(cssProperty)]=_getSetVendorStyleFunction(cssProperty)},dom.Element.preventDefaultFocusStyle=function(domElement){domElement.hideFocus=!0,0==(1&domElement.__ess_outlineDefined)&&dom.Element.setStyle(domElement,{outlineWidth:""}),0==(2&domElement.__ess_outlineDefined)&&dom.Element.setStyle(domElement,{outlineStyle:""}),0==(4&domElement.__ess_outlineDefined)&&dom.Element.setStyle(domElement,{outlineColor:""}),0==(8&domElement.__ess_outlineDefined)&&dom.Element.setStyle(domElement,{outlineOffset:""}),dom.Element.setStyle(domElement,{"-webkit-tap-highlight-color":"rgba(0,0,0,0)"})},dom.Element.hasNativeTransformSupport=function(){return _hasNativeTransformSupport()},dom.Element.hasNativeTransform3DSupport=function(){return _hasNativeTransform3DSupport()},dom.Element._updateIEFilter=function(domElement,filterName,propertyValues){try{var filter=domElement.filters.item(filterName);for(var property in propertyValues)filter[property]=propertyValues[property]}catch(e){var listArguments=[],i=0;for(var property in propertyValues){var propertyValue=propertyValues[property].valueOf();"string"==typeof propertyValue&&0<=propertyValue.indexOf(" ")&&(propertyValue="'"+propertyValue+"'"),listArguments[i++]=property+"="+propertyValue}domElement.style.filter+=" progid:"+filterName+"("+listArguments.join(",")+")",domElement.style.zoom=1}};var _outlineStylingFunction=function(outlineBits,outlineInitialValue){return function(domElement,cssCamelCaseProperty,cssValue){var ccVendorProperty=dom.Element.getCamelCaseVendorStyleProperty(cssCamelCaseProperty);ccVendorProperty&&(domElement.__ess_outlineDefined=""==cssValue?domElement.__ess_outlineDefined&~outlineBits:domElement.__ess_outlineDefined|outlineBits,domElement.hideFocus&&""==cssValue?_setDOMElementCamelCaseStyle(domElement,ccVendorProperty,outlineInitialValue):_setDOMElementCamelCaseStyle(domElement,ccVendorProperty,cssValue))}};dom.Element.addStyleSupport("outline",_outlineStylingFunction(7,"medium none black")),dom.Element.addStyleSupport("outline-width",_outlineStylingFunction(1,"medium")),dom.Element.addStyleSupport("outline-style",_outlineStylingFunction(2,"none")),dom.Element.addStyleSupport("outline-color",_outlineStylingFunction(4,"black")),dom.Element.addStyleSupport("outline-offset",_outlineStylingFunction(8,"0px")),dom.Element.addStyleSupport("opacity",function(domElement,cssCamelCaseProperty,cssValue){var ccVendorProperty=dom.Element.getCamelCaseVendorStyleProperty("opacity");if(ccVendorProperty)domElement.style[ccVendorProperty]=cssValue;else if("filters"in domElement){var opacity=100*parseFloat(cssValue);this._updateIEFilter(domElement,"DXImageTransform.Microsoft.Alpha",{Opacity:opacity,Enabled:!!(99.9>opacity)})}}),dom.Element.addStyleSupport("font",function(domElement,cssCamelCaseProperty,cssValue){var ccVendorProperty=dom.Element.getCamelCaseVendorStyleProperty("font");if(ccVendorProperty&&(domElement.style[ccVendorProperty]=cssValue,isMac&&"webkitFontSmoothing"in domElement.style)){var isBold=!1,regexBoldKeyword=/(^|\s)(bold|bolder)(\s|$)/;if(regexBoldKeyword.test(cssValue))isBold=!0;else{var regexWeightNumber=/(^|\s)(\d+)(\s|$)/,match=regexWeightNumber.exec(cssValue);match&&500<+match[2]&&(isBold=!0)}domElement.style.webkitFontSmoothing=isBold?"antialiased":""}}),dom.Element.addStyleSupport("font-weight",function(domElement,cssCamelCaseProperty,cssValue){var ccVendorProperty=dom.Element.getCamelCaseVendorStyleProperty("font-weight");ccVendorProperty&&(domElement.style[ccVendorProperty]=cssValue,isMac&&"webkitFontSmoothing"in domElement.style&&(""==cssValue||"normal"==cssValue||500>=+cssValue?domElement.style.webkitFontSmoothing="":domElement.style.webkitFontSmoothing="antialiased"))}),dom.Element.addStyleSupport("position",function(domElement,cssCamelCaseProperty,cssValue){if(domElement.style[cssCamelCaseProperty]=cssValue,"fixed"==cssValue){var ccVendorProperty=dom.Element.getCamelCaseVendorStyleProperty("backface-visibility");ccVendorProperty&&(domElement.style[ccVendorProperty]="hidden")}});var _selectableElements={input:!0,textarea:!0,object:!0,iframe:!0},_isElementForciblySelectable=function(domElement){if(domElement.tagName&&_selectableElements[domElement.tagName.toLowerCase()])return!0;for(var currentElement=domElement;currentElement&&""!==currentElement.contentEditable&&"true"!==currentElement.contentEditable&&"false"!==currentElement.contentEditable;)currentElement=currentElement.parentNode;return!!(currentElement&&"false"!==currentElement.contentEditable)},_isElementForciblyDraggable=function(domElement){for(var currentElement=domElement;currentElement;){var currentDraggableAttributeValue,currentDraggable;if(currentElement.__sm_userSelect&&"savedDraggableAttributeValue"in currentElement.__sm_userSelect?(currentDraggableAttributeValue=currentElement.__sm_userSelect.savedDraggableAttributeValue,currentDraggable="true"===currentDraggableAttributeValue):(currentDraggableAttributeValue=dom.Element.getAttribute(currentElement,"draggable"),currentDraggable=currentElement.draggable||"true"===currentDraggableAttributeValue),currentDraggable){if("img"!==(currentElement.tagName+"").toLowerCase()||"true"===currentDraggableAttributeValue)return!0;}else if("a"===(currentElement.tagName+"").toLowerCase()&&"false"!==currentDraggableAttributeValue)return!0;currentElement=currentElement.parentNode}return!1};dom.Element.addStyleSupport("user-select",function(domElement,cssCamelCaseProperty,cssValue){var ccVendorProperty=dom.Element.getCamelCaseVendorStyleProperty("user-select");if(ccVendorProperty&&(domElement.style[ccVendorProperty]=cssValue,"none"==cssValue&&0===ccVendorProperty.lastIndexOf("Moz",0)&&(domElement.style[ccVendorProperty]="-moz-none")),domElement.__sm_userSelect&&(dom.EventTarget.removeEventListener(domElement.__sm_userSelect.dragstart),dom.EventTarget.removeEventListener(domElement.__sm_userSelect.selectstart),dom.EventTarget.removeEventListener(domElement.__sm_userSelect.touchstart),dom.EventTarget.removeEventListener(domElement.__sm_userSelect.mousedown)),domElement.__sm_userSelect={},"none"==cssValue){domElement.unselectable="on",domElement.__sm_userSelect.selectstart=dom.EventTarget.addEventListener(domElement,"selectstart",function(event){if(!event.target.__sm_allowSelection&&!_isElementForciblySelectable(event.target)){if(window.getSelection)try{window.getSelection().removeAllRanges()}catch(e){}else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(e){}event.preventDefault()}}),domElement.__sm_userSelect.mousedown=dom.EventTarget.addEventListener(domElement,"mousedown",function(event){!event.target.__sm_allowSelection&&!_isElementForciblySelectable(event.target)&&!("savedDraggableAttributeValue"in domElement.__sm_userSelect)&&(domElement.__sm_userSelect.savedDraggableAttributeValue=dom.Element.getAttribute(domElement,"draggable"),dom.Element.setAttribute(domElement,"draggable",!0),setTimeout(function(){"savedDraggableAttributeValue"in domElement.__sm_userSelect&&(null==domElement.__sm_userSelect.savedDraggableAttributeValue?dom.Element.removeAttribute(domElement,"draggable"):dom.Element.setAttribute(domElement,"draggable",domElement.__sm_userSelect.savedDraggableAttributeValue),delete domElement.__sm_userSelect.savedDraggableAttributeValue)},0))}),domElement.__sm_userSelect.dragstart=dom.EventTarget.addEventListener(domElement,"dragstart",function(event){!event.target.__sm_allowSelection&&!_isElementForciblySelectable(event.target)&&!_isElementForciblyDraggable(event.target)&&event.preventDefault()});var ownerDocument=domElement.ownerDocument,touchEndEvent=null,touchCancelEvent=null,cancelTouch=function(){dom.EventTarget.removeEventListener(touchEndEvent),dom.EventTarget.removeEventListener(touchCancelEvent),setTimeout(function(){ownerDocument.documentElement.style[ccVendorProperty]=""},0)},touchEndHandler=function(event){0==event.touches.length&&cancelTouch()},touchStartHandler=function(event){1==event.touches.length&&!event.target.__sm_allowSelection&&!_isElementForciblySelectable(event.target)&&(ownerDocument.documentElement.style[ccVendorProperty]="none",touchEndEvent=dom.EventTarget.addEventListener(ownerDocument,"touchend",touchEndHandler,this,!0),touchCancelEvent=dom.EventTarget.addEventListener(ownerDocument,"touchcancel",cancelTouch,this,!0))};domElement.__sm_userSelect.touchstart=dom.EventTarget.addEventListener(domElement,"touchstart",touchStartHandler,this,{passive:!0})}else if(""==cssValue)dom.Element.removeAttribute(domElement,"unselectable");else{domElement.unselectable="off";var eventHandler=function(event){event.target.__sm_allowSelection=!0,setTimeout(function(){event.target.__sm_allowSelection=!1},0)};domElement.__sm_userSelect.dragstart=dom.EventTarget.addEventListener(domElement,"dragstart",eventHandler),domElement.__sm_userSelect.selectstart=dom.EventTarget.addEventListener(domElement,"selectstart",eventHandler),domElement.__sm_userSelect.touchstart=dom.EventTarget.addEventListener(domElement,"touchstart",eventHandler,this,{passive:!0}),domElement.__sm_userSelect.mousedown=dom.EventTarget.addEventListener(domElement,"mousedown",eventHandler)}});var _isLeftMouseEvent=function(event){return"which"in event?1==event.which:1==(1&event.button)};dom.Element.addStyleSupport("touch-callout",function(domElement,cssCamelCaseProperty,cssValue){var ccVendorProperty=dom.Element.getCamelCaseVendorStyleProperty("touch-callout");if(ccVendorProperty)domElement.style[ccVendorProperty]=cssValue;else if(domElement.__sm_touchCallout&&dom.EventTarget.removeEventListener(domElement.__sm_touchCallout.touchstart),domElement.__sm_touchCallout={},"none"==cssValue){var eventHandler=function(event){!_isLeftMouseEvent(event)&&(event.preventDefault(),event.stopPropagation())},ownerDocument=domElement.ownerDocument,contextmenuEvent=null,mousedownEvent=null,mouseupEvent=null,touchendEvent=null,touchcancelEvent=null,cancelTouch=function(){dom.EventTarget.removeEventListener(contextmenuEvent),dom.EventTarget.removeEventListener(mouseupEvent),dom.EventTarget.removeEventListener(mousedownEvent),dom.EventTarget.removeEventListener(touchendEvent),dom.EventTarget.removeEventListener(touchcancelEvent)},touchendHandler=function(event){0==event.touches.length&&cancelTouch()},touchstartHandler=function(event){1==event.touches.length&&!event.target.__sm_allowContextMenu&&(contextmenuEvent=dom.EventTarget.addEventListener(ownerDocument,"contextmenu",eventHandler,this,!0),mouseupEvent=dom.EventTarget.addEventListener(ownerDocument,"mouseup",eventHandler,this,!0),mousedownEvent=dom.EventTarget.addEventListener(ownerDocument,"mousedown",eventHandler,this,!0),touchendEvent=dom.EventTarget.addEventListener(ownerDocument,"touchend",touchendHandler,this,!0),touchcancelEvent=dom.EventTarget.addEventListener(ownerDocument,"touchcancel",cancelTouch,this,!0))};domElement.__sm_touchCallout.touchstart=dom.EventTarget.addEventListener(domElement,"touchstart",touchstartHandler,this,{passive:!0})}else if(""!=cssValue){var eventHandler=function(event){event.target.__sm_allowContextMenu=!0,setTimeout(function(){event.target.__sm_allowContextMenu=!1},0)};domElement.__sm_touchCallout.touchstart=dom.EventTarget.addEventListener(domElement,"touchstart",eventHandler,this,{passive:!0})}}),dom.Element.addVendorStyleSupport("border-radius"),dom.Element.addVendorStyleSupport("border-top-left-radius"),dom.Element.addVendorStyleSupport("border-top-right-radius"),dom.Element.addVendorStyleSupport("border-bottom-left-radius"),dom.Element.addVendorStyleSupport("border-bottom-right-radius"),dom.Element.addVendorStyleSupport("box-shadow"),dom.Element.addVendorStyleSupport("box-sizing")}()}(),function(){var _setImmediate,_clearImmediate,_protectedKey={};(function(){if(this.setImmediate&&this.clearImmediate)_setImmediate=this.setImmediate,_clearImmediate=this.clearImmediate;else{var global=this,nextHandle=1,handlers={};_clearImmediate=function(handle){delete handlers[handle]};var _runHandler=function(handle){var handler=handlers[handle];handler&&(_clearImmediate(handle),handler())},_addHandler=function(handler){return handlers[nextHandle]=handler,nextHandle++},_readyStateChangeAvailable=function(){return!!(global.document&&global.document.createElement)&&"onreadystatechange"in global.document.createElement("script")},prefix="#dom.TimerTask._setImmediate#"+Math.floor(9e8*Math.random()+1e8).toString(36)+"#";dom.EventTarget.addEventListener(global,"message",function(event){event.source===global&&"string"==typeof event.data&&0===event.data.lastIndexOf(prefix,0)&&_runHandler(event.data.substring(prefix.length))}),_setImmediate=function(handler){var handle=_addHandler(handler);return global.postMessage(prefix+handle,"*"),handle}}})();var _buildFunctionWithDefaultArguments=function(taskFunction,thisObject,defaultArgs){return function(){for(var actualArguments=Array.prototype.slice.call(arguments),nbArgs=Math.max(actualArguments.length,defaultArgs.length),i=0;i<nbArgs;i++)"undefined"==typeof actualArguments[i]&&(actualArguments[i]=defaultArgs[i]);return taskFunction.apply(thisObject,actualArguments)}},_buildFunctionWrapper=function(taskFunction,thisObject){var defaultArgs=Array.prototype.slice.call(arguments,2);if("function"==typeof taskFunction)return _buildFunctionWithDefaultArguments(taskFunction,thisObject,defaultArgs);if(thisObject&&"function"==typeof thisObject[taskFunction])return _buildFunctionWithDefaultArguments(thisObject[taskFunction],thisObject,defaultArgs);throw new Error(taskFunction+" is supposed to be a method of the object "+thisObject)};dom.Task=function(taskFunction,thisObject){this.__task_functionWrapper=taskFunction instanceof dom.Task?taskFunction.__task_functionWrapper:_buildFunctionWrapper.apply(this,arguments)},dom.Task.prototype.run=function(){return this.__task_functionWrapper.apply(null,arguments)};var _TIMEOUT=1,_INTERVAL=2,_IMMEDIATE=3,_scheduleImmediate=function(timerTask,handler){timerTask.__tt_timerIdType=_IMMEDIATE,timerTask.__tt_timerId=_setImmediate(handler)},_scheduleTimeout=function(timerTask,handler,delay){0>=delay?_scheduleImmediate(timerTask,handler):(timerTask.__tt_timerIdType=_TIMEOUT,timerTask.__tt_timerId=setTimeout(handler,delay))},_scheduleInterval=function(timerTask,handler,interval){if(0>=interval){var immediateHandler=function(){handler(),_scheduleImmediate(timerTask,immediateHandler)};_scheduleImmediate(timerTask,immediateHandler)}else timerTask.__tt_timerIdType=_INTERVAL,timerTask.__tt_timerId=setInterval(handler,Math.max(interval,1))},_getTaskFromTimerTask=function(timerTask){return timerTask.__tt_task};dom.TimerTask=function(task,delay,interval){if(arguments[arguments.length-1]===_protectedKey){this._super(task),this.__tt_task=task,this.__tt_timerId=0,this.__tt_timerIdType=null,this.__tt_delay=0,("number"==typeof delay||delay&&"number"==typeof delay.valueOf())&&(delay=+delay,this.__tt_delay=isFinite(delay)&&0<delay?delay:0),this.__tt_interval=null;var self=this;"number"==typeof interval||interval&&"number"==typeof interval.valueOf()?(interval=+interval,this.__tt_interval=isFinite(interval)&&0<interval?interval:0,this.__tt_delay===this.__tt_interval?_scheduleInterval(self,function(){self.run()},self.__tt_interval):_scheduleTimeout(self,function(){self.run(),_scheduleInterval(self,function(){self.run()},self.__tt_interval)},self.__tt_delay)):_scheduleTimeout(self,function(){self.run()},self.__tt_delay)}else throw new TypeError("Illegal constructor")},aleks.extend(dom.TimerTask,dom.Task),dom.TimerTask.prototype.cancel=function(){this.__tt_timerIdType===_TIMEOUT?clearTimeout(this.__tt_timerId):this.__tt_timerIdType===_INTERVAL?clearInterval(this.__tt_timerId):this.__tt_timerIdType===_IMMEDIATE&&_clearImmediate(this.__tt_timerId)},dom.Timer=function(){throw new TypeError("Illegal constructor")},dom.Timer.schedule=function(task,delay,interval){if(task instanceof dom.TimerTask)return new dom.TimerTask(_getTaskFromTimerTask(task),delay,interval,_protectedKey);if(task instanceof dom.Task)return new dom.TimerTask(task,delay,interval,_protectedKey);throw new Error("Task scheduling failed: "+task+" doesn't look like a Task")},dom.Timer.cancel=function(timerTask){timerTask instanceof dom.TimerTask&&timerTask.cancel()}}(),function(){dom.TimerManager=function(){this._listTasks=[]},dom.TimerManager.prototype.schedule=function(task,delay,interval){var timerTask=dom.Timer.schedule(task,delay,interval);return timerTask&&this._listTasks.push(timerTask),timerTask},dom.TimerManager.prototype.cancel=function(timerTask){for(var i=0;i<this._listTasks.length;i++)if(this._listTasks[i]===timerTask)return dom.Timer.cancel(timerTask),void this._listTasks.splice(i,1)},dom.TimerManager.prototype.cancelAllTasks=function(){for(var i=0;i<this._listTasks.length;i++)dom.Timer.cancel(this._listTasks[i]);this._listTasks=[]}}(),function(){var _reject,_protectedKey={},_isArray=function(){return Array.isArray?Array.isArray:function(arg){return"[object Array]"===Object.prototype.toString.call(arg)}}(),STATUS_PENDING=0,STATUS_RESOLVED=1,STATUS_FULFILLED=2,STATUS_REJECTED=3,_resolve=function(promise,value){if(promise.__promise_status!==STATUS_FULFILLED&&promise.__promise_status!==STATUS_REJECTED)if(promise.__promise_status=STATUS_RESOLVED,promise!==value){var valueThenable=!1;if("function"==typeof value||"object"==typeof value)try{var then=value.then;"function"==typeof then&&(then.call(value,function(newValue){_resolve(promise,newValue)},function(newReason){_reject(promise,newReason)}),valueThenable=!0)}catch(error){_reject(promise,error)}if(!valueThenable){promise.__promise_rejectedListeners=null,promise.__promise_status=STATUS_FULFILLED,promise.__promise_value=value;for(var i=0;i<promise.__promise_fulfilledListeners.length;i++)dom.Timer.schedule(new dom.Task(promise.__promise_fulfilledListeners[i],null,promise.__promise_value));promise.__promise_fulfilledListeners=null}}else _reject(promise,new TypeError("Resolve a promise with itself"))},_reject=function(promise,reason){if(promise.__promise_status!==STATUS_FULFILLED&&promise.__promise_status!==STATUS_REJECTED){promise.__promise_fulfilledListeners=null,promise.__promise_status=STATUS_REJECTED,promise.__promise_value=reason;for(var i=0;i<promise.__promise_rejectedListeners.length;i++)dom.Timer.schedule(new dom.Task(promise.__promise_rejectedListeners[i],null,promise.__promise_value));promise.__promise_rejectedListeners=null}},__fallbackPromise=function(callback){if("function"==typeof callback){this.__promise_fulfilledListeners=[],this.__promise_rejectedListeners=[],this.__promise_status=STATUS_PENDING,this.__promise_value=null;var promise=this;try{callback(function(value){promise.__promise_status===STATUS_PENDING&&_resolve(promise,value)},function(reason){promise.__promise_status===STATUS_PENDING&&_reject(promise,reason)})}catch(e){promise.__promise_status===STATUS_PENDING&&_reject(promise,e)}}else throw new TypeError("Promise constructor takes a function argument")};__fallbackPromise.prototype.then=function(onFulfilled,onRejected){var promise=this;return new __fallbackPromise(function(resolve,reject){var _buildCallback=function(callbackFunction,isRejected){return"function"==typeof callbackFunction?function(value){try{resolve(callbackFunction(value))}catch(e){reject(e)}}:callbackFunction instanceof dom.Task?function(value){try{resolve(callbackFunction.run(value))}catch(e){reject(e)}}:isRejected?function(reason){reject(reason)}:function(value){resolve(value)}},isFulfilledCallback=_buildCallback(onFulfilled,!1);if(promise.__promise_status==STATUS_FULFILLED)dom.Timer.schedule(new dom.Task(isFulfilledCallback,null,promise.__promise_value));else{var isRejectedCallback=_buildCallback(onRejected,!0);promise.__promise_status==STATUS_REJECTED?dom.Timer.schedule(new dom.Task(isRejectedCallback,null,promise.__promise_value)):(promise.__promise_fulfilledListeners.push(isFulfilledCallback),promise.__promise_rejectedListeners.push(isRejectedCallback))}})},__fallbackPromise.prototype.finally=function(onFinally){return this.then(onFinally,onFinally)},__fallbackPromise.prototype.catch=function(onRejected){return this.then(null,onRejected)},__fallbackPromise.resolve=function(value){return new __fallbackPromise(function(resolve,reject){resolve(value)})},__fallbackPromise.reject=function(reason){return new __fallbackPromise(function(resolve,reject){reject(reason)})},__fallbackPromise.all=function(promises){var arrayPromises=promises;if(!_isArray(arrayPromises)&&(arrayPromises=[]),0<arrayPromises.length){var promiseValues=[],remainingUnresolvedPromises=arrayPromises.length;return new __fallbackPromise(function(resolve,reject){for(var i=0;i<arrayPromises.length;i++)__fallbackPromise.cast(arrayPromises[i]).then(function(i){return function(value){promiseValues[i]=value,0>=--remainingUnresolvedPromises&&resolve(promiseValues)}}(i),function(reason){reject(reason)})})}return __fallbackPromise.resolve([])},dom.Promise=global.Promise?global.Promise:__fallbackPromise,dom.Promise.cast=function(promise){return promise instanceof dom.Promise?promise:dom.Promise.resolve(promise)},dom.Promise.chainPromises=function(promiseArray,ignoreRejects){return promiseArray.length?new dom.Promise(function(resolve,reject){for(var currentCallback=resolve,i=promiseArray.length-1;0<i;i--)currentCallback=function(targetPromise,promiseCallback){targetPromise.then(promiseCallback,ignoreRejects?reject:promiseCallback)}.bind(this,promiseArray[i],currentCallback);promiseArray[0].then(currentCallback,ignoreRejects?reject:currentCallback)}):dom.Promise.resolve()}}(),function(){var _relativeURLToAbsolute=function(){var _cache={};return function(relativeURL){if(null==_cache[relativeURL]){var div=document.createElement("div"),a=document.createElement("a");a.href=relativeURL,div.appendChild(a),div.innerHTML=div.innerHTML,_cache[relativeURL]=div.firstChild.href+""}return _cache[relativeURL]}}(),_getHeadElement=function(){var head=document.head||document.getElementsByTagName("head")[0];return!head&&(head=document.createElement("head"),document.documentElement.insertBefore(head,document.documentElement.firstChild)),head};(function(){var _createScriptElement=function(src){var scriptElement=document.createElement("script");return scriptElement.type="text/javascript",scriptElement.src=src,scriptElement},_loadedScripts={};dom.ScriptLoader=function(){throw new TypeError("Illegal constructor")},dom.ScriptLoader.load=function(src){var absoluteURL=_relativeURLToAbsolute(src);return!_loadedScripts[absoluteURL]&&(_loadedScripts[absoluteURL]=new dom.Promise(function(resolve,reject){var head=_getHeadElement(),eventManager=new dom.EventManager,scriptElement=_createScriptElement(absoluteURL),cleanup=function(){eventManager.removeAllEventListeners()},resolveFileLoaded=function(){cleanup(),resolve(absoluteURL)},rejectFileNotFound=function(){cleanup(),scriptElement.parentNode&&scriptElement.parentNode.removeChild(scriptElement),delete _loadedScripts[absoluteURL],reject(new Error("Script at "+absoluteURL+" could not be loaded."))};eventManager.addEventListener(scriptElement,"load",function(){resolveFileLoaded()}),eventManager.addEventListener(scriptElement,"error",function(){rejectFileNotFound()}),head.appendChild(scriptElement);var scriptElementIE=_createScriptElement(absoluteURL);eventManager.addEventListener(scriptElementIE,"readystatechange",function(){"complete"==scriptElementIE.readyState?resolveFileLoaded():"loaded"==scriptElementIE.readyState&&(scriptElementIE.children,"complete"==scriptElementIE.readyState?resolveFileLoaded():dom.Timer.schedule(new dom.Task(function(){rejectFileNotFound()})))})})),_loadedScripts[absoluteURL]}})(),function(){var _createLinkElement=function(src,opt_media){var linkElement=document.createElement("link");return linkElement.rel="stylesheet",linkElement.type="text/css",null!=opt_media&&""!=opt_media+""&&(linkElement.media=opt_media+""),linkElement.href=src,linkElement},_loadedStyleSheets={};dom.StyleSheetLoader=function(){throw new TypeError("Illegal constructor")},dom.StyleSheetLoader.load=function(src,opt_media){var absoluteURL=_relativeURLToAbsolute(src),stylesheetKey=absoluteURL+"@"+opt_media;return!_loadedStyleSheets[stylesheetKey]&&(_loadedStyleSheets[stylesheetKey]=new dom.Promise(function(resolve,reject){var head=_getHeadElement(),eventManager=new dom.EventManager,linkElement=_createLinkElement(absoluteURL,opt_media),cleanup=function(){eventManager.removeAllEventListeners()},resolveFileLoaded=function(){cleanup(),resolve(absoluteURL)},rejectFileNotFound=function(){cleanup(),linkElement.parentNode&&linkElement.parentNode.removeChild(linkElement),delete _loadedStyleSheets[stylesheetKey],reject(new Error("Style sheet at "+absoluteURL+" could not be loaded."))},hasOnLoadEvent=("onload"in linkElement);hasOnLoadEvent&&(eventManager.addEventListener(linkElement,"load",function(){resolveFileLoaded()}),eventManager.addEventListener(linkElement,"error",function(){rejectFileNotFound()})),head.appendChild(linkElement),!hasOnLoadEvent&&resolveFileLoaded()})),_loadedStyleSheets[stylesheetKey]}}(),function(){var _preloadedImages={};dom.ImagePreloader=function(){throw new TypeError("Illegal constructor")},dom.ImagePreloader.preload=function(src){var absoluteURL=_relativeURLToAbsolute(src);return!_preloadedImages[absoluteURL]&&(_preloadedImages[absoluteURL]=new dom.Promise(function(resolve,reject){var head=_getHeadElement(),eventManager=new dom.EventManager,cleanup=function(){eventManager.removeAllEventListeners()},resolveFileLoaded=function(){cleanup(),resolve(absoluteURL)},rejectFileNotFound=function(){cleanup(),delete _preloadedImages[absoluteURL],reject(new Error("Image at "+absoluteURL+" could not be loaded."))},imgElement=document.createElement("img");eventManager.addEventListener(imgElement,"load",function(){resolveFileLoaded()}),eventManager.addEventListener(imgElement,"error",function(){rejectFileNotFound()}),imgElement.src=src})),_preloadedImages[absoluteURL]}}()}(),function(){var _relativeURLToAbsolute=function(){var _cache={};return function(relativeURL){if(null==_cache[relativeURL]){var div=document.createElement("div"),a=document.createElement("a");a.href=relativeURL,div.appendChild(a),div.innerHTML=div.innerHTML,_cache[relativeURL]=div.firstChild.href+""}return _cache[relativeURL]}}(),_getHeadElement=function(){var head=document.head||document.getElementsByTagName("head")[0];return!head&&(head=document.createElement("head"),document.documentElement.insertBefore(head,document.documentElement.firstChild)),head},_getReferenceURL=function(){function _getReferenceURL(url,targetWindow){return targetWindow?(!targetWindow.__fileLoaderReferenceIndex&&(targetWindow.__fileLoaderReferenceIndex="fileLoaderWindow"+_targetWindowAutoIndex,_targetWindowAutoIndex++),targetWindow.__fileLoaderReferenceIndex+"_"+url):url};var _targetWindowAutoIndex=0;return _getReferenceURL}();(function(){dom.AJAXFileLoader=function(){throw new TypeError("Illegal constructor")};var _requestedFiles={},_loadedFiles={},_failedFiles={};dom.AJAXFileLoader.getLoadedFiles=function(){return JSON.parse(JSON.stringify(_loadedFiles))},dom.AJAXFileLoader.loadFileList=function(fileList,options){if(!Array.isArray(fileList))throw new Error("Incorrect argument: expected Array.");!options&&(options={});var pendingPromises=[],cleanedFileList=fileList.reduce(function(fileArray,filePath){var absoluteURL=_relativeURLToAbsolute(filePath),referenceURL=_getReferenceURL(absoluteURL,options.targetWindow);return!options.synchronous&&_requestedFiles[referenceURL]instanceof dom.Promise&&0>pendingPromises.indexOf(_requestedFiles[referenceURL])?pendingPromises.push(_requestedFiles[referenceURL]):_canLoadFile(referenceURL,options)&&(fileArray.push(absoluteURL),_requestedFiles[referenceURL]=!0),fileArray},[]);if(!options.synchronous){var loadingPromise;return loadingPromise=0==cleanedFileList.length&&0==pendingPromises.length?dom.Promise.resolve():0<pendingPromises.length?new dom.Promise(function(resolve,reject){dom.Promise.chainPromises(pendingPromises,!0).then(_loadRequestedFiles.bind(this,cleanedFileList,options,resolve,reject))}):new dom.Promise(function(resolve,reject){_loadRequestedFiles(cleanedFileList,options,resolve,reject)}),cleanedFileList.forEach(function(filePath){var referenceURL=_getReferenceURL(filePath,options.targetWindow);!0===_requestedFiles[referenceURL]&&(_requestedFiles[referenceURL]=loadingPromise)}),loadingPromise}_loadRequestedFiles(cleanedFileList,options)};var _canLoadFile=function(filePath,options){return(!_loadedFiles[filePath]||options.forceLoad)&&(!_failedFiles[filePath]||options.forceRetry)&&!_requestedFiles[filePath]},_loadRequestedFiles=function(cleanedFileList,options,resolve,reject){try{if(0==cleanedFileList.length)if(!options.synchronous)resolve();else return;var filesData=[];cleanedFileList.forEach(function(filePath){var fileRequest={filePath:filePath,fileReference:_getReferenceURL(filePath,options.targetWindow),fileType:_getFileType(filePath),targetWindow:options.targetWindow},attemptTracker={filePath:filePath,attemptsMade:0,resolveValues:[],rejectValues:[]};filesData.push(fileRequest),fileRequest.dataPromise=_loadFileContent(fileRequest,attemptTracker,options),options.synchronous?_executeFileContent(fileRequest.fileType,fileRequest.filePath,fileRequest.fileReference,fileRequest.dataPromise):fileRequest.dataPromise.then(_handleFileContent.bind(this,filesData,fileRequest,options,resolve,reject),_handleFileLoadingError.bind(this,filesData,fileRequest,options,resolve,reject))})}catch(e){console.log("Error during _loadRequestedFiles: "+e)}},_loadFileContent=function(fileRequest,tracker,options){var ajaxRequest=new XMLHttpRequest,__MAXIMUM_ATTEMPTS_ALLOTTED=5;if(!options.synchronous){for(var filePromise=__getLoadFileContentPromise(fileRequest,ajaxRequest,tracker,options),i=0;i<__MAXIMUM_ATTEMPTS_ALLOTTED;i++)filePromise=filePromise.then(null,function(){return tracker.attemptsMade++,__getLoadFileContentPromise(fileRequest,ajaxRequest,tracker,options)});return filePromise=filePromise.then(null,function(msg){if(options.preventLoadDefaultError)return filePromise;var _aleks$analyticsAPI;null===(_aleks$analyticsAPI=aleks.analyticsAPI)||void 0===_aleks$analyticsAPI||null===(_aleks$analyticsAPI=_aleks$analyticsAPI.error)||void 0===_aleks$analyticsAPI||_aleks$analyticsAPI.reportError("fileLoadingError (dom_core.js): "+msg),!msg.match(/\.css/)&&(window.parent&&window.parent.displayALEKSLoadingErrorSplash?window.parent.displayALEKSLoadingErrorSplash(msg):displayALEKSLoadingErrorSplash&&displayALEKSLoadingErrorSplash(msg))}),filePromise}if(ajaxRequest.open("GET",fileRequest.filePath,!1),ajaxRequest.send(),200!=ajaxRequest.status&&options.languageSuffix&&options.languageDefaultSuffix&&options.languageSuffix!=options.languageDefaultSuffix&&-1<fileRequest.filePath.indexOf(options.languageSuffix)){var newPath=fileRequest.filePath.replace(options.languageSuffix,options.languageDefaultSuffix);ajaxRequest.open("GET",newPath,!1),ajaxRequest.send()}return ajaxRequest.responseText},__getLoadFileContentPromise=function(fileRequest,ajaxRequest,attemptTracker,options){return new dom.Promise(function(resolve,reject){var rejectWithTracker=function(rejectValue){return attemptTracker.rejectValues.push(rejectValue),reject(rejectValue)},resolveWithTracker=function(resolveValue){return attemptTracker.resolveValues.push(resolveValue),resolve(resolveValue)},handleRequestReject=__handleRequestReject.bind(this,fileRequest,options,resolveWithTracker,rejectWithTracker,attemptTracker),requestStateChange=__requestStateChange.bind(this,fileRequest,ajaxRequest,resolveWithTracker,handleRequestReject);ajaxRequest.addEventListener("readystatechange",requestStateChange),ajaxRequest.open("GET",fileRequest.filePath,!0),ajaxRequest.send()})};let __formatErrorMessage=function(){let fileRequest=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},ajaxRequest=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return`${ajaxRequest.status||"Unknown"}: ${fileRequest.filePath}`};var __requestStateChange=function(fileRequest,ajaxRequest,resolve,reject){4>ajaxRequest.readyState||(200==ajaxRequest.status?resolve(ajaxRequest.responseText):reject(__formatErrorMessage(fileRequest,ajaxRequest)))},__handleRequestReject=function(fileRequest,options,resolve,reject,attemptTracker,statusText){if(options.languageSuffix&&options.languageDefaultSuffix&&options.languageSuffix!=options.languageDefaultSuffix&&-1<fileRequest.filePath.indexOf(options.languageSuffix)){var newPath=fileRequest.filePath.replace(options.languageSuffix,options.languageDefaultSuffix);_loadFileContent(newPath,attemptTracker,options).then(resolve,reject)}else reject(statusText)},_handleFileContent=function(dataArray,requestObject,options,resolve,reject,fileData){for(requestObject.fileData=fileData;0<dataArray.length&&dataArray[0].fileData!=null;){var targetFile=dataArray.shift();_executeFileContent(targetFile.fileType,targetFile.filePath,targetFile.fileReference,targetFile.fileData,targetFile.targetWindow)}0==dataArray.length&&resolve()},_executeFileContent=function(fileType,filePath,fileReference,fileData,targetWindow){if(!targetWindow&&(targetWindow=global),"js"==fileType)try{targetWindow.eval.call(targetWindow,fileData+`\n//# sourceURL=${filePath}`),_loadedFiles[fileReference]=!0,delete _requestedFiles[fileReference]}catch(e){console.error(`Error executing file ${filePath}`),console.error(e),_failedFiles[fileReference]="ExecutionError: "+e.stack,delete _requestedFiles[fileReference]}else"css"==fileType&&(_getHeadElement(targetWindow).appendChild(_createCSSElement(targetWindow,fileData)),_loadedFiles[fileReference]=!0,delete _requestedFiles[fileReference])},_handleFileLoadingError=function(dataArray,requestObject,options,resolve,statusText){_failedFiles[requestObject.fileReference]=statusText,delete _requestedFiles[requestObject.fileReference];var requestIndex=dataArray.indexOf(requestObject);0<=requestIndex&&dataArray.splice(requestIndex,1),0==dataArray.length&&!options.synchronous&&resolve()},_getFileType=function(filePath){if(filePath.match(/\.css$/)||filePath.match(/\.css?.*$/))return"css";return filePath.match(/\.js$/)||filePath.match(/\.js?.*$/)?"js":void 0},_getHeadElement=function(targetWindow){var head=targetWindow.document.head||targetWindow.document.getElementsByTagName("head")[0];return!head&&(head=targetWindow.document.createElement("head"),targetWindow.document.documentElement.insertBefore(head,targetWindow.document.documentElement.firstChild)),head},_createCSSElement=function(targetWindow,cssText){var linkElement=targetWindow.document.createElement("style");return linkElement.innerHTML=cssText,linkElement}})()}(),function(){dom.EventManager.addEventListener=function(domElement,eventName,listener,targetObject,useCapture){return dom.EventTarget.addEventListener(domElement,eventName,listener,targetObject,useCapture)},dom.EventManager.addLegacyEventListener=function(domElement,eventName,listener,targetObject){return dom.EventTarget.addLegacyEventListener(domElement,eventName,listener,targetObject)},dom.EventManager.removeEventListener=function(eventListenerRef){return dom.EventTarget.removeEventListener(eventListenerRef)},dom.EventManager.dispatchEvent=function(domElement,eventName,eventSource){return dom.EventTarget.dispatchEvent(domElement,eventName,eventSource)},dom.NodeManager=dom.Node,dom.ElementManager=dom.Element,dom.PositionManager=dom.Element,dom.FocusManager=dom.Element,dom.StyleManager=dom.Element}();